understanding the differences between contrasting groups is a fundamental task in data analysis. this realization has led to the development of a new special purpose data mining technique  contrast-set mining. we undertook a study with a retail collaborator to compare contrast-set mining with existing rule-discovery techniques. to our surprise we observed that straightforward application of an existing commercial rule-discovery system  magnum opus  could successfully perform the contrast-set-mining task. this led to the realization that contrast-set mining is a special case of the more general rule-discovery task. we present the results of our study together with a proof of this conclusion.
categories and subject descriptors
h.1  database management : database applications- data mining; i.1  artificial intelligence : learning; h.1  information storage and retrieval : information search and retrieval
keywords
contrast-set discovery  rule discovery  retailing
1.	introduction
　contrast-set mining is a new data mining technique designed specifically to identify differences between contrasting groups from observational multivariate data  1  1 . this paper reports on a project undertaken to evaluate how contrastset mining differs from pre-existing forms of rule-discovery in an applied context. working with the marketing group in one of australia's largest discount department store companies  we undertook a contrast mining project to which we applied three alternative data mining techniques  with unexpected and surprising results.
　the project involved contrasting the pattern of retail activity on two different days selected to highlight the effect of specific marketing promotions on purchasing behavior. we
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. to copy otherwise  to republish  to post on servers or to redistribute to lists  requires prior specific permission and/or a fee.
sigkdd '1  august 1  1  washington  dc  usa copyright 1 acm 1-1/1 ...$1.
were provided with transaction data from the two days. the data consisted of all items purchased in six selected stores  each item associated with a transaction id allowing it to be related to other items bought by the same customer at the same time. due to the nature of the comparison that was desired  this data was aggregated up the product hierarchy to the department level  resulting in a total of 1 'items ' each representing the purchase of one or more products from a specific department. the data mining task was to identify how the 'baskets' of departments differed between the days. the three systems studied were stucco   magnum opus   and c1rules . stucco was selected because it represents the contrast sets technique: the only data mining approach of which we are aware that is specifically designed for identifying contrasts between groups. magnum opus and c1rules were selected as representatives of alternative data mining approaches that have previously been claimed  to be unsuited to performing the type of contrast analysis for which contrast sets were designed.
　magnum opus is a general purpose rule-discovery system. it implements the opus ar rule-discovery algorithm . it provides association-rule-like functionality  but does not use the frequent-itemset strategy  and hence does not require the specification of a minimum-support constraint.
　c1rules derives classification rules by first learning a decision tree and then transforming that tree into a rule format. it and the other two systems are described in more detail in section 1.
　to evaluate the suitability of the three techniques we first applied each to the data and compared the models that were produced. this is described in section 1. as expected  c1rules developed very different models to the other two systems. to our surprise  however  magnum opus found rules corresponding to all contrast sets discovered by stucco  and more besides. this violated our prior expectation that the special purpose contrast discovery process of stucco would be better suited to the contrast discovery task than the more general rule-discovery process of magnum opus.
　part of the claim in support of the contrast set approach is that it incorporates selection mechanisms that prevent irrelevant differences from being included in the selected contrast sets. to evaluate this aspect of the technique we had two marketing managers from the retailer assess all rules produced by stucco and magnum opus. the details of this comparison are provided in section 1 and conclusions presented in the final section.
1.	thethreetechniquesandtheir application
　we first describe the three systems and then discuss how they were applied to the data.
1	stucco
　stucco is designed to be applied to grouped categorical attribute-value data. the following description is based on that of bay and pazzani   with some notational differences introduced for ease of comparison between algorithms.
　the data is a set of groups g1 g1 ...gl. each group is a collection of objects o1 ...on. each object oi is a set of k attribute-value pairs  one for each of the attributes a1 ...ak. attribute aj has values drawn from the set
vj1 ...vjm.
　a contrast set is a set of attribute-value pairs with no attribute ai occurring more than once. this is equivalent to an itemset in association-rule discovery when applied to attribute-value data. similar to an itemset  we measure the support of a contrast set. however  support is defined with respect to each group. the support of a contrast set cset with respect to a group gi is the proportion of the objects o （ gi such that cset   o  and is denoted supp cset gi .
　contrast set discovery seeks to find all contrast sets whose support differs meaningfully across groups. this is defined as seeking all contrasts sets cset that satisfy both
	 ijp cset|gi  =1	p cset|gj 	 1 
and max|supp cset gi    supp cset gj | − δ  1  ij
where δ is a user-defined threshold called the minimum support-difference. contrast sets for which eq. 1 is statistically supported are called significant and those for which eq. 1 is satisfied are called large. note that these are different expressions of the same core principle  that the frequency of the contrast set must differ meaningfully across groups. eq. 1 provides the basis of a statistical test of 'meaningful ' while eq. 1 provides a quantitative test thereof. while bay and pazzani define contrast set discovery in these terms  we take the core objective of contrast discovery to be to find contrast sets that satisfy eq. 1 in a manner that is meaningful to the individual or organization that has commissioned the analysis. the concepts of 'significant' and 'large' contrasts are simply mechanisms that are intended to identify such meaningful contrasts.
　stucco employs an efficient search through the space of contrast sets using an algorithm based on bayardo's maxminer  rule-discovery algorithm. the statistical significance of eq. 1 is assessed using a chi-square test to assess the null hypothesis that contrast set support is independent of group membership. a correction for multiple comparisons is applied that systematically lowers the value of α as the size of the contrast sets increases. this mechanism controls the probability of type-one error  incorrectly accepting that a contrast exists . at each level i of the search  level i explores contrast sets containing i attribute-value pairs  a corrected significance level αi is set
	 	 1 
where α is the initial significance level  1  and |ci| is the number of candidate contrast sets at level i of the search.
　further pruning is employed to remove contrast sets that  while significant and large  derive those properties only due to being specializations of more general contrast sets that also have those properties. for this reason any specialization is pruned that has similar support to its parent or that fails a chi-square test of independence with respect to its parent. finally  the search space below a contrast set cset is pruned if the support for the group with the highest support remains highest no matter what additional terms are added to cset. precise details of these complex pruning mechanisms are provided by bay and pazzani .
　contrast sets are justified as a distinct data mining technique on the grounds that other existing techniques cannot perform the same analysis. classification learning  such as decision trees or decision rules  appear unlikely to find all meaningful contrasts. a classification learner finds a single model that maximizes the separation of multiple groups  not all interesting models as contrast discovery seeks. however  it might be that classification learning finds the most interesting set of contrasts. we seek to test this possibility in our study  below.
　bay and pazzani  argue that association rules are also incapable of finding contrasts  even when the group is encoded as an explicit variable  because
 association rule discovery will not  return group differences  and the results will be difficult to interpret.  with reference to an example.  first  there are too many rules to compare. second  the results are difficult to interpret because the rule learner does not enforce consistent contrast   i.e.  using the same attributes to separate groups.  ... finally  even with matched rules  we still need a proper statistical comparison to see if differences in support and confidence are significant.
we initially accepted this argument and expected our study to provide support therefore. we were surprised when it became apparent that straightforward application of the commercial rule-discovery system magnum opus could indeed find group differences of a form that were straightforward to interpret. admittedly  however  magnum opus is not a standard association-rule-discovery system. in order to explain how it is capable of performing this task we next provide a summary of its relevant capabilities.
1	magnum opus
　magnum opus is a commercial implementation of the opus ar  rule-discovery algorithm. opus ar extends the opus  search algorithm to support search for rules of the form antecedent ★ consequent where the antecedent is a set  or conjunction  of attribute-value pairs and the consequent can be any one of a set of allowed attributevalue pairs. this differs from opus and other similar rulediscovery algorithms such as max-miner  that require that the consequent be limited to a single target attribute-value pair. however  it turns out that the ability to consider multiple attributes in the role of the consequent is not required for the contrast discovery task and that a rule discovery system based on the opus or max-miner architectures would suffice. to apply magnum opus to the contrast discovery task we restricted it to considering for the consequent the values of an attribute representing group membership.
　opus performs efficient search through the space of possible rules for a single consequent by systematically exploring the space of possible sets of attribute-value pairs that might form an antecedent. at the time of its development  opus improved upon previous systematic rule search algorithms  1  1  1  1  by
  supporting the propagation of pruning between the children of a node by representing the view of a node as an explicit set that may be manipulated  and
  introducing the technique of dynamic reordering of the search-space in order to improve search efficiency.
both of these innovations were independently rediscovered by bayardo  and incorporated in max-miner.
　magnum opus utilizes the opus systematic search approach to perform association-rule-like search. however  it differs from conventional association-rule discovery by not employing the frequent-itemset strategy. hence  it does not require that constraints be placed on the minimum support for a rule. instead  it requires that a measure of rule value or interest be specified along with the maximum number of rules  maxr to be returned. it returns the maxr rules that optimize the specified measure of rule value and satisfy other user-specified constraints. search efficiency is obtained by pruning sections of the search space that cannot contain one of the target rules. the system does not require that the measure of rule value be monotonic  although pruning is often more efficient with respect to monotonic measures.
　the measures of rule value that magnum opus implements are support  confidence  called strength within the system   lift  coverage  and leverage. coverage is the support of the antecedent. if the consequent of a rule is a value of a variable identifying a group  then the antecedent might be considered to be a contrast set  in which case the coverage will be the support of that contrast set for the group identified by the consequent. however  the measure on which we will concentrate is leverage  as that is the default measure used in magnum opus and the measure used in our study.
　most measures of rule interest are based on the degree to which the observed joint frequency of the antecedent and consequent differ from the joint frequency that would be expected if the antecedent and consequent were independent of each other. leverage measures the magnitude of this
difference
 leverage a ★ c  = supp a“{c}  supp a 〜supp {c}   1  where supp x  is the proportion of objects in the data that contain x. leverage is a useful measure for many rule discovery tasks as it identifies the inter-relationships between antecedents and consequents that represent large increases in the number of individuals involved over that expected if there were no such inter-relationship. thus  for example  if the consequent represents high-profit customers then the rule with the greatest leverage will represent the sub-group of the customer base that contains the most high-profit customers in excess of those that would be expected in a random sub-group of the same size.
　magnum opus provides numerous facilities for controlling the set of rules that are discovered. in this project  however  other than the specification that the consequent must be a value specifying group membership  it was employed with default settings only. of those  the measure relevant to the outcome of this research is the rule filter facility. this allows certain types of rules that are unlikely to be of interest to be pruned during the search process.
　the default rule filter seeks to prune all rules r for which the confidence is not significantly different to the confidence of a generalization of r. to express this in a similar form to eq. 1  it seeks to prune rules a ★ c that do not satisfy
	 x ap c|a    p c|x .	 1 
due to the computational requirements of strictly enforcing this constraint  magnum opus  employs a heuristic approach that does not guarantee its universal application. however  the heuristic does guarantee the enforcement of
	p c|a    p c 	 1 
and
        x a …  x ★ c  （ result p c|a    p c|x   1  where result is the set of rules returned at the end of the search. in other words  it is guaranteed that the confidence of a rule a ★ c in the set presented to the user will differ significantly both from the confidence of   ★ c and from the confidence of any generalization of a ★ c that is presented to the user. note that eq. 1 is strictly equivalent to requiring that lift be greater than 1  a constraint frequently enforced by association-rule-discovery systems.
　whereas stucco uses a chi-square test of significance when assessing eq. 1  magnum opus uses a binomial sign test when assessing eq. 1  1  and 1. unlike stucco  magnum opus does not correct for multiple comparisons. the reason for this apparent omission is that corrections for multiple comparisons maintain the experiment-wise risk of typeone error but massively increase the risk of type-two error. the philosophy enshrined in magnum opus is that data mining is by its nature statistically unsound and that any 'knowledge' mined should be independently verified externally to the data mining process. the use of a statistical test in magnum opus is regarded as a useful heuristic rather than a guarantee of statistical soundness.
1	c1rules
　c1rules  discovers classification rules by first discovering a decision tree  then converting that tree to an equivalent set of rules  then simplifying those rules. as this system is one of the best known in machine learning and the finer details of how it operates do not appear relevant to our study  we will not seek to describe it here in detail.
　the aim of classification-rule discovery is quite different to that of either contrast-set discovery or association-rule discovery. whereas the later both seek to find all sets or rules that satisfy some set of constraints with respect to the data  classical classification-rule discovery seeks to find a small set of rules that are sufficient to allow class prediction. while such rules might be the most predictive  they may not include all rules that are most interesting to a user. nonetheless  in our experience  classification-rule discovery is often employed in real-world data mining applications in which the objective is to find interesting rather than predictive rules.
table 1: descriptive statistics
statisticday 1  august-1th day 1  august-1st no. transactions on each day1average no. depts. per transaction11top department1 items from dept 1 items from dept 1second top department1 items from dept 1 items from dept 1third top department1 items from dept 1 items from dept 1fourth top department1 items from dept 1 items from dept 1fifth top department1 items from dept 1 items from dept 1sixth top department1 items from dept 1 items from dept 1seventh top department1 items from dept 1 items from dept 1eighth top department1 items from dept 1 items from dept 1ninth top department1 items from dept 1 items from dept 1tenth top department1 items from dept 1 items from dept 1　the natural way in which to apply classification-rule discovery to the contrast-discovery task would appear to be to encode the groups as a class variable and then to learn rules to distinguish the groups. this might be expected to result in a set of rules that concisely capture key characteristics that distinguish the groups. this is how bay and pazzani  suggest it should be used and is how we employed it in this study.
　aside from the manner in which c1rules creates a small set of discriminating rules  the rules created differ in a further interesting manner from the style of contrast sets or of the rules formed by magnum opus. we have configured stucco and magnum opus to produce contrast sets and rules that contain only elements of the form dept = 1  each representing that items from the department were purchased in a transaction. however  it is not possible to restrict c1rules in this way and hence c1rules' antecedents can also contain elements of the form dept = 1  which in the context of the current project amounts to a negative condition  that no products were purchased from a department. one of the issues that we sought to assess in our study was whether such negative conditions might be desirable in the marketing context.
1	applying the systems to the data
　as described in the introduction  the data was marketbasket data representing all the transactions at 1 stores on two distinct days  aggregated to the department level. each transaction was represented by the set of departments from which purchases were made. the task was to contrast the purchasing behavior of customers on the two days.
　table 1 provides simple high-level descriptive statistics that support the retailers' expectation that there should be differences in purchasing behavior. the second day has more transactions  and each transaction on average contains items from a greater number of departments. while the top two departments are the same for both days  the third top department on each day does not appear in the top ten departments on the other day.
　both stucco and c1rules require that data be formatted in a tabular attribute-value format. we processed the data into this format  representing each transaction as a single case with 1 binary attributes  one per department  with the value 1 representing one or more purchases from the department and 1 representing no purchases from that department. in order to prevent contrast sets that contained negative elements  stucco was configured to ignore 1 values. due to the way c1rules treats missing values  this was not an option for c1rules. for stucco  each day's table 1: a contrast set as output by stucco
1 = 1
1 | 1 1
============================
d.f. chi 1 pvalue 1.1.1e-1
============================
data was stored in a separate file. for c1rules  all data was stored in a single file and an additional binary attribute was added to distinguish the days. this additional attribute was treated as the class attribute.
　stucco and c1rules were both applied with default settings. for stucco these included the significance level 1 and the minimum support-difference 1.
　magnum opus accepts data in transaction format. to enable the required group comparison to be performed  each transaction was augmented with an additional 'item' representing the day on which the transaction occurred. magnum opus was applied to this data with default settings augmented by a single constraint that the consequents of the rules were restricted to the values representing the two days. note that the default settings seek the 1 rules that maximize leverage within those that satisfy the constraint that every rule must have significantly higher confidence than its generalizations.
1.	comparison of rules produced
　stucco produced 1 contrast sets  magnum opus produced 1 rules  and c1rules produced 1 rules. all of stucco's contrast sets contained a single value. the first set is reproduced in table 1. the first line lists that contrast set. the first two values on the second line represent the number of transactions that contained the department 1 on each day. the next two values show the proportion of the transactions for the day that this value represents. the remaining lines list the results of the chi-square test of significance.
　that magnum opus only produced 1 rules demonstrates that only 1 rules satisfied the constraint that every rule must have significantly higher confidence than its generalizations. in consequence  the same rules would have been produced irrespective of which of the six measures of rule table 1: six rules as output by magnum opus
1 -  august-1st  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
1 -  august-1st  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
1 & 1 -  august-1st  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
1 -  august-1th  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
1 -  august-1th  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
1 & 1 -  august-1st  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
value the system was requested to maximize. the use of leverage has not been significant to the outcomes of this study.
　magnum opus produced 1 rules containing a single value in the antecedent  1 containing two values  and four containing three values. all values in the two and three condition rules were also represented in a one condition rule. some example rules are reproduced in table 1. the values in brackets after each rule represent the values of the named measures of rule quality and interest. the coverage is the proportion of transactions over the two days that included purchases from the set of departments listed in the antecedent. the support is the proportion of all transactions that included the departments and were on the day specified by the consequent. the value in brackets following each of these measures is the number of transactions that the respective value represents. note how the more specific rules  containing more conditions  have higher confidence  called strength by magnum opus  than the more general rules containing the same conditions. this is guaranteed by the rule filter that is applied. note also that the dates have been changed here and throughout the paper in order to maintain commercial confidentiality.
　the first three rules show the typical relationship between two more general rules and a more specific rule containing multiple departments. the first two rules indicate that the proportion of customers buying from each of departments 1 and 1 on the second day was higher than the first. the third rule indicates that this effect was heightened when customers that bought from both departments in a single transaction were considered. the next three rules are particularly interesting. whereas items for departments 1 and 1 were each purchased more frequently on august 1 than august 1  a greater proportion of customers bought items from both departments on the 1st than the 1th.
table 1: three rules as output by c1rules
rule 1:
1 = 1
-  class august-1st  1% 
rule 1:
1 = 1
1 = 1
1 = 1 = 1 = 1 = 1 = 1 = 1 = 1
-  class august-1st  1% 
rule 1:
1 = 1 = 1 = 1 = 1 = 1 = 1 = 1 = 1 = 1 = 1 = 1 = 1 = 1
-  class august-1th  1% 
　c1rules produced 1 rules. five rules contained one condition  two rules contained two conditions  three rules contained three conditions  and the remaining rules were of a variety of sizes up to 1 conditions. table 1 reproduces a single-condition rule  a nine-condition rule and a 1-condition rule. the value in brackets represents the confidence of the rule. note the negative conditions in the longer rules. all but two rules contained just one positive condition  dept = 1  with the remaining conditions all being negative  dept = 1 . the remaining two rules were the longest rules and contained solely negative conditions. all but one of the rules with one positive condition corresponded to a rule found by magnum opus. the one exception is rule 1  the last rule displayed in table 1.
　table 1 provides a high level summary of the interrelationships between the various rules. each row corresponds to a rule with a single-department antecedent discovered by magnum opus. each department has been given a unique identifier  which is listed in the first column. each rule or contrast set produced by each system has been numbered using the order in which they were listed by the system. the second column presents the rule number of the single-department rule produced by magnum opus that contains the department specified in the first column. the third column lists any multiple-department rules that refer to that department. the stucco column lists the label of the contrast set that contains the department  if any. if a c1rules
　
table 1: comparison of rules discovered
magnum opus
dept.rule num.rule num.stuccoc1rules single condition  multiple conditions rule num.rule num.p111.11  11.111111111111111.111111.111.111111  1  1  11.1111111.11  11.111.11  111111111111.11111111111  1  1  1  111111.11  1  1  11.1111111111111111  1  1  1  111111111111111.111111111111.111111111111111111111111　
rule contains a condition specifying the inclusion of the department to which a row relates  the label for that rule is displayed in the c1rules column. hence rule 1 appears in the row for department 1. the final column provides the p value produced by a chi-square test of independence between the department and the group variable. this provides an indication of whether an apparent correlation between a department and date is merely a random happenchance. the table is sorted on this column.
1 the relationship between stucco and magnum opus
　the first striking observation that we made was that magnum opus had produced rules corresponding to all contrast sets found by stucco. this violated our expectations  as we had presumed that the two systems were engaging in quite different forms of analysis. this led us to re-evaluate this presumption and eventually to the realization that their core activities are equivalent.
　stucco seeks contrast sets that satisfy eq. 1. if the antecedents are treated as contrast sets and the consequents as groups  from eq. 1 it follows that magnum opus seeks contrasts sets cset that satisfy
	 ip gi |cset    p gi .	 1 
in a traditional association-rule-discovery framework eq. 1 equates to finding associations between contrast sets and groups such that lift   1  a constraint that is frequently applied. at first sight eq. 1 appears very different to eq. 1. however  as the following theorem and proof demonstrate  they are equivalent. thus  contrast set discovery and general rule discovery constrained to use only the group identifier as a consequent both seek to identify equivalent situations. they differ only in how they assess whether a group differ-
ence is meaningful.	p
theorem. if all csets belong to a group   
1  and no group is empty   i : 1 ＋ i ＋ l 1   p gi  ＋
1  then
	 ip gi |cset  p gi  《  ij p cset|gi 1=p cset|gj 	 1 
　proof. from the definition of conditional probability it follows that

from the definition of conditional probability we obtain
	《  ip cset|gi    p cset .	 1 
to provide a formal derivation of the next step requires a long proof by contradiction. due to space constraints we provide here only an outline of that proof. we start with the identity p cset  =
 . in consequence  the term p cset 
can be considered a weighted average with non-zero weights of p cset|g1  p cset|g1  ...p cset|gl . as a result of this  eq. 1 entails that there is a p cset|gi  that is greater than the weighted average over all groups. as it is impossible for all p cset|gi  to be greater than their cumulative weighted average  it follows that  ij p cset|gi    p cset|gj . this in turn entails eq. 1  with possible reversal of the roles of i and j . in the converse  if a set of values are not all identical  any weighted average with non-zero weights of the values in that set must be less than the maximum value in the set. as p cset  equals such a weighted average of p cset|g1  p cset|g1  ...p cset|gl  it follows that eq. 1 entails maxi=1...l p cset|gi     p cset . this in turn entails eq. 1. as we have established that eq. 1 and eq. 1 each entail the other  we can conclude
	《  ij p cset|gi  1= p cset|gj .	 1 

　the main respect in which the two systems differ from each other  then  is in the application of filters that seek to identify and remove spurious contrast sets. magnum opus uses a binomial sign test and stucco uses a chi-square test. we believe that the chi-square test is a better test for the contrast-discovery task  because it is more sensitive to a small range of extreme forms of contrast. however  we do not believe that this will be a practical consideration in most contrast discovery tasks and certainly was not a practical issue in the current project. rather  we believe that the most important difference between the filters that the two systems apply is stucco's use of a correction for multiple comparisons and the enforcement of a minimum difference. as discussed above  magnum opus does not apply such a correction so as to avoid increasing type-two error. also  stucco applies a constraint on the minimum magnitude of the difference between groups whereas magnum opus by default does not. in consequence  magnum opus' filter is much more lenient than stucco's  resulting in the observed difference that magnum opus finds many more rules than stucco. this leads to the question of which strategy is best. we seek to explore this issue in the context of the current project in section 1.
　the main respect in which the two systems differ from traditional association-rule-discovery are in the application of a statistical test to filter out uninteresting rules rather than a minimum-support constraint and in the restriction of the consequent to the group identifier. to assess the importance of the first of these differences we applied christian borgelt's  implementation of apriori to the data. we used the built-in mechanism of the system to restrict the consequent of a rule to a day identifier. by setting the minimum confidence to 1 and the minimum support and lift to appropriate values it was possible to obtain a variety of different collections of rules  ranging from 1 to 1 rules in total . there was no obvious way  however  to configure the system to filter the most useful rules for this application. our assessment  which admittedly could not be considered independent  is that the type of filtering by statistical significance advocated by bay and pazzani  is important in this application.
1.	an assessment of rule quality
an analysis of the rules produced by magnum opus and
stucco provides examples of both cases that in our estimation justify stucco's application of a stricter filter and those that justify magnum opus' application of a less stringent filter.
　consider from the rules produced by magnum opus that are listed in section 1 the following:
1 & 1 & 1 -  august-1st  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
this represents an example that might justify the more stringent filter that stucco applies. it has very low coverage but very high confidence  strength  and lift. our assessment is that there is a very high likelihood that this rule is spurious.
　on the other hand  the following rule strikes us as an excellent example of the potential value of magnum opus' more lenient criteria.
1 & 1 -  august-1st  coverage=1  1 ;
support=1  1 ; strength=1; lift=1; leverage=1  1  
this rule identifies two departments that appear together on the second day far more often than on the first. if this is indeed a genuine effect  it is surprising because each department appears without the other much more frequently on the first day than the second. it is true that the number of cases involved is low and that there is a risk that this rule represents a spurious correlation  but that risk must be traded against the degree of surprisingness of the rule and hence its potential value if it is not spurious. the probability of the observed frequencies or more extreme being observed if there were no relationship between the antecedent and the consequent is 1  assessed using a two-tailed binomial sign test . our belief is that if there is a business case for the exploration of this rule  it would be worth further investigation  which should  of course  include evaluation of the likelihood that it is spurious.
1	comparing	stucco's	and	magnum
opus' contrasts
　to evaluate whether the more stringent filter applied by stucco is warranted we returned to our retail collaborators and sought an assessment of each contrast set that stucco and magnum opus had identified. as the raw output of neither system is very suited for presentation of group differences to a retail marketing manager  we developed a simple automated filter that translated the rules into a more suitable format. table 1 displays examples of a contrast in this format. note that these example contrasts are entirely fictitious and that the department names have been changed here and throughout the paper in order to maintain commercial confidentiality.
　as all stucco contrast sets were represented by magnum opus rules  we presented only the magnum opus rules  in this format  in the order produced by magnum opus. thus  the contrasts discovered by stucco were in no way distinguished from those not discovered  and were intermixed in the order in which they were presented. due to the need to gain assessments of a large number of rules and our reluctance to impose unduly upon our voluntary collaborators  we asked only for a simple true/false assessment of the following two questions with respect to each rule.
table 1: three contrasts as presented to the users
on august 1st customers were 1 times more likely to purchase items from department 1  menswear; mens nightwear  than they were on august 1th. they were bought in 1% of transactions on august 1st and 1% of transactions on august 1th.
on august 1th customers were 1 times more likely to purchase items from department 1  girls toys  and 1  boys toys  than they were on august 1st. they were bought in 1% of transactions on august 1th and 1% of transactions on august 1st.
on august 1st customers were 1 times more likely to purchase items from department 1  books  and 1  stationery  and 1  confectionery  than they were on august 1th. they were bought in 1% of transactions on august 1st and 1% of transactions on august 1th.
q 1. is this rule surprising 
q 1. is this rule potentially useful to the organization 
table 1 summarises the results of this investigation. we list the number of contrasts that were assessed as each surprising and potentially useful of those discovered by each system. as stucco's filter penalises contrasts containing more elements  it is interesting to see whether the rules containing more departments that magnum opus found are assessed as less surprising or less potentially useful. for this reason  the table first presents the rules discovered by magnum opus grouped by the number of departments in the contrast  and then aggregated results for all rules. as previously discussed  all stucco contrasts contained only a single department.
　to our surprise  despite the greater selectiveness of the filter that it applies  a much lower proportion of the rules discovered by stucco were considered surprising by the retail experts. one possible explanation for this is that some of the magnum opus contrasts are actually spurious and hence are considered surprising because they do not actually have any basis in fact. to assess this possibility we performed chisquare tests of independence on all the contrasts and then a one-tailed homoscedastic t-test of the resulting probabilities of the surprising and the unsurprising rules. this test failed to find a significant difference in the chi-square probabilities of the two groups  t = 1 p = 1 . to illustrate this apparent lack of inter-relationship between the probability that the antecedent and consequent are independent and the assessments of surprisingness  figure 1 plots the chi-square test probabilities for each of the rules  with those rules identified as surprising distinguished from those that are not. note that the x-axis is ordered by magnum opus' output order  from highest to lowest leverage  an ordering correlated with chi-square test probabilities.
　the proportion of contrasts assessed as potentially useful are very similar between magnum opus and stucco. a chi-square test of independence indicates that the difference is not significant at the 1 level  χ1 = 1  df=1  p =
systemtotal no rulessurprisingpotentially usefulmagnum opus  1 dept. 1  1% 1  1% magnum opus  1 depts. 1  1% 1  1% magnum opus  1 depts. 1  1% 1  1% magnum opus  all 1  1% 1  1% stucco1  1% 1  1% table 1: summary of assessments
figure 1: plot of surprising and not surprising contrasts by chi-square p
1 .
　considering the magnum opus rules with differing numbers of departments  the proportion drops slightly for the two department and three department contrasts. however  a chi-square test of independence indicates that this variation in proportions is not significant  χ1 = 1  df=1  p = 1 .
1	an assessment of negative conditions
　as noted above  our assessment from comparing the three systems' outputs was that c1rules had not identified many of the key contrasts. the system is not designed to perform this task and does not appear suited to the task. there are two striking differences between the rules produced by c1rules and those produced by the other systems. first  some of the rules identify relatively small differences in frequency between the two classes. this is presumably because they are introduced by the system in an attempt to find some form of discrimination between large numbers of cases that could not be covered by rules with greater discriminate performance. the second difference is that the rules produced by c1rules contain negative conditions. because of the nature of the system there was no way to block this. as our prior expectation was that negative conditions would not be of value we configured both stucco and magnum opus to prevent them. due to our strong expectations about the likely outcomes and our desire to minimize the imposition on our industry collaborators we decided not to present the rules produced by c1rules for assessment of surprisingness and potential usefulness. instead  we presented the set of rules and asked only for a simple assessment of whether the negative conditions were of potential value. the following is a fictitious example of such a rule in the format that we employed.
on august 1 customers were 1 times more likely to purchase items from department 1  infants; diapers  and nothing from department 1  beverages; beer  than they were on august 1. this occurred in 1% of transactions on august 1 and 1% of transactions on august 1.
the response from our industry collaborators was that while negative conditions of these form were of potential value  these specific rules did not appear to be of interest and were more difficult to interpret than the magnum opus and stucco rules.
　this response is an interesting one. while it provides some support for our belief that classification rule discovery is not an appropriate approach to contrast discovery  it indicates that techniques that develop contrasts with negative conditions may be of value in at least this application. to develop useful techniques of this form may be quite a challenge  as straightforward application of either stucco or
magnum opus with negative conditions enabled produces sets of contrasts strongly dominated by negative conditions. this is because negative conditions have far greater cover than positive conditions and hence have greater potential to produce rules with strong effects. however  our intuition is that negative conditions will only be considered valuable in the current application when their effect is quite exceptional.
1.	conclusions
　we set out to compare the performance of three alternative data mining techniques on a contrast-discovery task. to our surprise we discovered that the core contrast-setdiscovery task as defined by eq. 1 is strictly equivalent to a special case of the more general rule-discovery task  eq. 1 . this in no way devalues the key contribution of bay and pazzani   which is the identification of contrast discovery as a new and valuable data mining task and the characterization of its requirements.
　from our study and analysis we reach the following conclusions about contrast analysis and identify the following issues as worthy of further investigation.
　first  the application of some form of filter to remove spurious correlations is important. the exact form that such a filter should take is  however  an area that is ripe for further research. our investigation suggests that neither stucco nor magnum opus is applying a perfect filter. stucco seems to discard some contrasts of potential value. magnum opus appears to include some contrasts that are very probably spurious. however  in our study both systems were applied with default settings  and it is likely that tuning of their existing mechanisms to the specific task would result in better performance.
　it would be interesting to investigate in greater depth the issue of whether there is a substantial difference between the application of a chi-square test of independence and a binomial sign test as a filter.
　it would also be interesting to investigate further the relative merits of adjusting the statistical tests to allow for multiple comparisons. our belief is that it is inadvisable to do so  because it will result in unacceptable type-two error. rather  we should take account of the likelihood of type-one error in the assessment and investigations subsequent to the initial contrast-discovery process.
　another issue revealed by our research is the need for appropriate methods to describe the contrasts that are discovered. it is clear that the traditional association-rule measures of support  confidence and lift are not directly appropriate. it is likely  however  that related measures would be useful. it would be valuable to study what information users find useful and how that information can be presented clearly and concisely.
　in summary  the current research has heightened our appreciation of the importance of contrast analysis. as our theorem proves  existing rule-discovery techniques can be applied to perform the core contrast-discovery task. however  it is possible that new techniques are required for filtering the contrasts that are considered potentially interesting. finally  there is a need to develop appropriate methods for describing contrasts to end-users.
1.	acknowledgments
we greatly appreciate enthusiasm and support of our anonymous retail collaborators. we wish to thank stephen bay for supplying stucco and christian borgelt for supplying apriori. we also greatly appreciate stephen bay's constructive comments on an early draft of the paper. we are also grateful to john crossley and ying yang for assistance with refining the presentation of our proof.
