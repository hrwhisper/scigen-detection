in this study  a novel multidimensional time series classification technique  namely support feature machine  sfm   is proposed. sfm is inspired by the optimization model of support vector machine and the nearest neighbor rule to incorporate both spatial and temporal of the multi-dimensional time series data. this paper also describes an application of sfm for detecting abnormal brain activity. epilepsy is a case in point in this study. in epilepsy studies  electroencephalograms  eegs   acquired in multidimensional time series format  have been traditionally used as a gold-standard tool for capturing the electrical changes in the brain. from multi-dimensional eeg time series data  sfm was used to identify seizure pre-cursors and detect seizure susceptibility  pre-seizure  periods. the empirical results showed that sfm achieved over 1% correct classification of per-seizure eeg on average in 1 patients using 1-fold cross validation. the proposed optimization model of sfm is very compact and scalable  and can be implemented as an online algorithm. the outcome of this study suggests that it is possible to construct a computerized algorithm used to detect seizure pre-cursors and warn of impending seizures through eeg classification.
categories and subject descriptors
i.1  pattern recognition : applications-signal processing  waveform analysis
general terms
algorithms  design  experimentation  performance
keywords
classification  time series  epilepsy  optimization

 this material is based upon work supported by the national science foundation under grant no. 1.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. to copy otherwise  to republish  to post on servers or to redistribute to lists  requires prior specific permission and/or a fee.
kdd'1  august 1  1  san jose  california usa.
copyright 1 acm 1-1-1/1 ...$1.
1.	introduction
﹛the human brain is among the most complex systems known to man. the rapidly growing technology in the past decade has made it possible for physicians to capture simultaneous responses from brain functions to test many longstanding brain theories. almost all experiments in brain research have resulted in massive amounts of data. often time  the captured information flood from brain diagnosis like neuroimaging and neurophysiological signals is in the form of large spatial and temporal data  also known as multidimensional time series  mdts . very few studies in brain research and data mining have been tailored to exploit both spatial and temporal properties of these brain data  1  1  1 . the exploration of such massive medical data requires very efficient and sophisticated techniques capable of capturing both spatial and temporal properties simultaneously.
﹛in this research  we herein propose a novel spatio-temporal classification technique  called support feature machine  sfm   used to classify multi-dimensional time series data. epilepsy is a case in point in this study. an application of sfm will be demonstrated through the classification of normal and abnormal  pre-seizure  brain activity using electroencephalograms  eegs  data. eeg  acquired in mdts format  has been traditionally used as a tool for capturing the electrical changes and evaluating physiological states  normal and abnormal  of the brain. sfm can be used in developing a novel online classification paradigm that can accurately and reliably differentiate pre-seizure from normal eegs. as seizure occurrence is always believed to be random  the classification framework proposed in this study is among the pioneering attempts to tackle the seizure prediction challenge  1  1 . the outcome of this study may improve the medical diagnosis and prognosis in epilepsy as well as other abnormal brain functions like sleep disorders  movement disorders  and cognitive disorders. in addition  sfm can also be applied to other real life spatio-temporal data mining problems like anomaly detection or event prediction problems. a typical electrode montage for intracranial eeg recordings used in our study is shown in figure 1a  which is a modified image of brain anatomy in . an emerging view in recent epilepsy research suggests that there are four stages evolved in the seizure process: normal  pre-seizure  seizure onset  and postseizure  1  1 . the state transition of seizure evolution has also been confirmed by our previous studies  1  1  1  and other groups  1  1  1 . the 1-second eeg profiles during these stages are illustrated in figures 1b.
 a 	 b 
placement for eeg recordings  are depicted. subdural electrode strips are placed over the left orbitofrontal
 lof   right orbitofrontal  rof   left subtemporal  lst   and right subtemporal  rst  cortex.rtd	ltd	depth
electrodes are placed in the left temporal depth  ltd  and right temporal depth  rtd  to record hippocampal activity;  b  twenty-second eeg recordings of  b1  normal activity  b1  pre-seizure activity  b1  seizure onset activity  b1  post-seizure activity from patient 1 obtained from 1 electrodes. each horizontal trace represents the voltage recorded from electrode sites listed in the left column  see for anatomical location ofelectrodes .
1	epilepsy and abnormal brain activity
﹛epilepsy can be broadly defined as recurring seizures - sudden  brief changes in the way the brain works . the most disabling aspect of epilepsy is the uncertainty of recurrent seizures  which can be characterized by a chronic medical condition produced by temporary changes in the electrical function of the brain. although neurological signals like eegs offer good spatial and excellent temporal resolution to characterize rapidly changing electrical activity of brain activation  neuroscientists understand very little about the dynamical transitions to neurological dysfunctions of seizures. the unpredictable occurrence of seizures has presented special difficulties regarding the ability to investigate the factors by which the initiation of seizures occurs in humans and how to prevent seizures from happening. if seizures could be anticipated  it would lead to the development of completely novel diagnostic and therapeutic advances in controlling epileptic seizures. finding hidden patterns or relationships in eeg data may offer a possibility to better understand brain functions from a system perspective  which will generally be very useful in medical diagnosis. thus  the necessary first step to advance research in seizure prediction is to develop novel techniques capable of recognizing and capturing epileptic activity in eegs before seizures occur. the discriminant ability to detect the seizure susceptibility period  seizure precursor  is logically a prerequisite of seizure prediction/warning development.
1	optimization and classification
﹛classification has been used for a wide variety of tasks in data mining. there are a wide variety and technical sophistication of the classification techniques. for example  there is a rich body of work in both statistical modeling  e.g.  bayesian models  and optimization  e.g.  neural networks  for classification techniques. since this paper is focused on a new optimization model for mdts data  we give a short review on previous studies using optimization for classification. generally  classification techniques are combinatorial in nature as they involve discrete decisions  assignment of data points into a class . thus  classification problems can be naturally posted as discrete optimization problems  1  1 . the research in developing discrete optimization for classification problems is not new. the pioneering work was introduced in the 1's . nevertheless  optimization in classification and data mining research is still very challenging and remains intractable because the goal classification naturally lends itself to a discrete optimization problem. aside from the complexity issue  the massive scale of real life classification problems is another difficulty arising in optimization in data mining research. there have been enormous number of optimization techniques for classification problems developed during the past few decades including classification tree  support vector machines  svms   linear discriminant analysis  logistic regression  least squares  nearest neighbors  etc. for example  there are a number of linear programming formulations for svms proposed to explore the properties of the structure of the optimization problem and solve large-scale problems  1  1 . there have been a few studies in data mining investigating the application of data mining techniques in mdts classification problems. guyon et al.  1   proposed a new feature subset selection  fss  technique  recursive feature elimination method  to pre-process mdts data or multivariate time series  before using svm to classify cancer genes. subsequently  yang et al.  1   proposed an improved fss technique that utilizes the correlation coefficient matrix.
1	contribution of the paper
﹛this paper proposes a novel spatio-temporal classification technique to enhance the ability to classify mdts data. the proposed technique can be used to discriminate preseizure eeg signals  seizure pre-cursor  from normal eeg signals. one of the most challenging aspects in this study is the fact that eeg data are massive with an average over 1 data points per 1-minute of all electrode recordings. we propose an eeg feature extraction technique based on the chaos theory to reduce the dimensionality of eeg data. since mdts data like eegs have properties in space and time  good mdts classification techniques should be able to incorporate both spatial and temporal characteristics. to the best of our knowledge  this study represents the first attempt to formulate an optimization model to capture spatiotemporal properties for mdts classification. the proposed technique  sfm  can incorporate both spatial and temporal properties by employing statistical time series analysis and the nearest neighbor rule within the optimization model. the sfm optimization model is to select the dimensions  features  of the mdts that will maximize the correct classification subject to the nearest neighbor rule on inter-class and intra-class time series statistical distances. the optimal features that maximize the classification accuracy will be selected and used in the testing phase. the solution to an sfm problem is also easy for the end users  e.g.  physicians  to interpret. for instance  in our case  the sfm solution is a group of electrodes that show the most discriminating power in normal and pre-seizure eeg classification.
1	paper organization
﹛the organization of the succeeding sections of this paper is as follows. in section 1  the method used to extract features from eeg data  statistical measures in time series analysis  and optimization models for sfm are described. the eeg data description and experimental design are presented in section 1. the classification results and the performance characteristics of the proposed technique are addressed in section 1. the concluding remarks are given in section 1.
1.	methodology
﹛the spatio-temporal classification framework developed in this study is comprised of 1 key steps. the first step is the feature extraction from multi-channel eeg data. in this study  we employ a quantitative measure of brain dynamics from eeg data. the measure of brain dynamics  based on the chaos theory  has been previously shown capable of contemplating dynamical mechanisms of the brain network from eeg signals . after the brain dynamical measure for each eeg channel is calculated  the subsequent step is the selection of time series similarity measures. we herein employ 1 time series similarity measures to the analysis of brain dynamics in eeg time series. those measures include euclidean  t-statistical  and dynamic time warping distances. the third step is the classification algorithm  which is based on optimization models used to classify unlabeled samples based on the nearest neighbor rule. integration of the optimization models and the nearest neighbor rule results into a novel mdts classification technique  called sfm  which is used to classify normal and pre-seizure eegs in this study.
1	eeg feature extraction
﹛quantification of the brain dynamics from eegs in this study is suitable to the extraction of eeg data because it is capable of automatically identifying and appropriately weighing existing transients in the eeg data. this technique is motivated by mathematical models from chaos theory used to characterize multi-dimensional complex systems and reduce the dimensionality of eegs  1  1 . to quantify the brain dynamics  we divide eeg signals into sequential 1-second epochs  non-overlapping windows . to properly account for possible nonstationarities in eeg signals  we chose the window size of 1-second  or 1 eeg data points  such that it is large enough to capture the periodic motion and small enough to satisfy the stationarity assumption . for each epoch of each channel of eeg signals  we estimate the measure of chaos  known as short-term maximum lyapunov exponent  stlmax   to quantify the chaoticity of the attractor using the method proposed in  1  1 . a chaotic system like human brain is a system in which orbits that originate from similar initial conditions or nearby points in the phase space diverge exponentially in expansion process. the rate of divergence is an important aspect of the dynamical system and is reflected in the value of lyapunov exponents. in other words  the lyapunov exponents measure the average uncertainty along the local eigenvectors of an attractor in the phase space . next  we will give a short overview of mathematical models used in the estimation of stlmax from eeg signals.
1.1	eeg time series embedding
﹛the initial step in extract dynamical features from eeg signals is to embed data from each eeg channel in a higher dimensional space of dimension p. this technique is known as the method of delays   which is used to capture the temporal behavior of the p variables that are primarily responsible for the dynamics of the eeg. we can construct p-dimensional vectors x t   whose components consist of values of the recorded eeg signal x t  at p points in time separated by a time delay as:
       xi =  x ti  x ti + 而 ...x ti +  p   1    而    1  where 而 is the selected time lag between the components of each vector in the phase space  p is the dimension of the embedding phase space  and ti ﹋  1 t    p   1 而 . in this study  we use p = 1 and 而 = 1 as it was shown to be the most appropriate setting  i.e.  best trade-off between the computational effort and epileptic activity characterization  . an eeg signal embedded in the phase space are illustrated in figure 1.
1.1	estimation of short-term maximum lyapunov exponent  stlmax 
﹛the method for estimation of stlmax for nonstationary data  e.g.  eeg time series  is previously explained in  1  1 . in this section  we will only give a short description and basic notation of our mathematical models used to estimate stlmax. define na as the number of local stlmax's that will be estimated within a duration t data segment. if we define dt as the the sampling period of the time domain data  we then have t =  n   1 dt = na t +  p   1 而. let
x ti  be the point of the fiducial trajectory 耳t x t1   with t = ti  x t1  =  x t1  ... x t1 +  p   1    而    and x tj  be a properly chosen vector adjacent to x ti  in the phase

figure 1: diagram illustrating an eeg epoch embedded in phase space for the quantification of brain dynamics: assume p = 1. the fiducial trajectory  the first three local lyapunov exponents  l1  l1  l1   is shown.
space. define 汛xi j 1  = x ti    x tj  as the displacement vector at ti  i.e.  a perturbation of the fiducial orbit at ti  and 汛xi j  t  = x ti+ t  x tj + t  as the evolution of this perturbation after time  t. denote ti = t1+ i 1   t and tj = t1 +  j   1     t  where i ﹋  1 na  and j ﹋  1 n  with j 1= i. let  t be the evolution time for 汛xi j  i.e.  the time one allows 汛xi j to evolve in the phase space. t1 is defined as the initial time point of the fiducial trajectory and coincides with the time point of the first data in the data segment of analysis. in the estimation of stlmax  for a complete scan of the attractor  t1 should move within  1  t . finally  stlmax is defined as the average of local lyapunov exponents in the state space and can be calculated by the following equation:
	.	 1 
1	constructing distance matrix: similarity measures
﹛in this study  the choice of similarity measures is a very important step in achieving accurate classification results. to our knowledge  we are the first to develop a framework incorporating statistical time series similarity measures for differentiating eeg signals from normal and pre-seizure states. we will also apply and compare the performance of those similarity measures  including euclidean  t-statistical  index   and dynamic time warping distances. each of these measures can give us different aspects and insights about temporal and spatial characteristics of eeg signals.
1.1	dynamic time warping  dtw  distance
﹛give two time series  or vector sequences  x and y of equal length |x| = |y | = n  dtw is a distance  similarity  measure used to compute the best alignment warp between time series x and time series y with the minimum distortion. dtw has been widely used in many contexts including data mining  1  1   gesture recognition   speech processing   and medicine . the dtw distance can be calculated by using a dynamic programming approach. first  construct an alignment of every data point in time series x to match with every point in time series y . the n℅n alignment matrix will then be constructed by using the euclidean distance as the local distance between two vectors  d xi yj  =  xi yj 1  where the  ith jth  element of the matrix is the distance d xi yj  between the ith point of time series x  and the jth point of time series y . subsequently  we construct a warp path  w = w1 ... wk  starting at the beginning of each time series  w1 =  1   and finishing at the end of both time series  wk =  n n . note that k is the length of the warp path and max |x| |y |  ≒ k   |x|+|y |. the kth element of the warp path represents the matching point of two time series  wk =  i j   where  i j  corresponds to index i from time series x  and index j from time series y  shown in figure 1 . there is also another constraint on the warp path to be monotonically increasing in indices. specifically  if wk =  i j  and wk+1 =  i1 j1   then a warp path must satisfy i ≒ i1 ≒ i + 1 and j ≒ j1 ≒ j + 1. there exist an exponential number of warping paths that satisfy the above conditions. however  the optimal warp path is the one with a minimum warping  distortion  cost defined by . using a dynamic
=1
programming approach  the warp path must either be incremented by one unit  adjacent  or stay at the same i or j axes. therefore  we only need to evaluate the recurrence of the cumulative distance found in the adjacent elements:
path:
in this study  we employ an additional global constraint on the warping path described in  1  1 . the main idea of this additional constraint is to speed up dtw distance calculation as well as to prevent pathological warping. pathological warping occurs when a relatively small section of one sequence maps onto a relatively large section of another. the global constraints  known as sakoe-chiba band   is given by y   r ≒ x ≒ y + r  where r = 1 1  see figure 1 when r = 1 . here  we treat r as a parameter in our dtw distance calculation and we will pick the best value of r empirically  i.e.  the value that yields the maximum classification accuracy .

figure 1: warping paths and global constraints: a warping matrix and a constrained warping matrix with the minimum-distance warp path of two time series x and y .
1.1	t-statistical distance  t-index 
﹛the t-test is commonly used to determine if two time series differ from each other in a significant way under the assumptions that the paired differences are independent and identically normally distributed. note that the t-test deals with the problems associated with inference based on small samples  epochs of time series   which implies that the calculated mean and standard deviation may deviate from the  real  mean and standard deviation. the t-index is a similarity degree from the paired t-test for comparisons of means of paired-dependent observations. in this study  we use the t-index as a measure of statistical distance between two time series. specifically  it is used to estimate the difference of the eeg signals from different brain states. the t-index  txy  between the time series and y = y1 ... yn is then defined as  where 考|x y| is the sample standard deviation of the absolute difference between time series x and y estimated over a window with the length n. note that the t-index follows a t-distribution with n   1 degrees of freedom.
1.1	euclidean distance
   the euclidean distance is the most commonly used similarity measure. it is easy to understand and bear certain success in many classification problems. it measures the degree of similarity in terms of intensity of the data. in short  the euclidean distance tells us an average of the difference in intensity of two time series. the euclidean distance  ed  between the time series and y of length n is defined as: p=1
1 optimization models for support feature machine  sfm 
