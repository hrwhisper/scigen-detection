we empirically study phase transitions of the asymmetric traveling salesman. using random instances of up to 1 cities  we show that many properties of the problem  including the backbone and optimal tour cost  experience sharp transitions as the precision of intercity distances increases across a critical value. we also show that the average computational cost of the well-known branch-and-bound subtour elimination algorithm for the problem also exhibits a threshold behavior  transitioning from easy to difficult as the distance precision increases. these results provide strong positive evidences to a decade-long open question regarding the existence of phase transitions of the traveling salesman. 
1 introduction 
phase transition refers to such a phenomenon of a system in which some global properties change rapidly and dramatically when a control parameter crosses a critical value. a simple example of phase transition is water changing from the liquid phase to the solid phase when the temperature drops below the freezing point. phase transitions of combinatorial problems and threshold behavior of combinatorial algorithms have drawn much attention in recent years . it has been shown that many combinatorial decision problems have phase transitions  such as boolean satisfiability  1; 1; 1   graph coloring  and number partitioning . 
모another useful concept for characterizing combinatorial problems is that of backbones  1; 1 . a backbone variable refers to such a variable that has a fixed value in all solutions of a problem. all such backbone variables are collectively referred to as the backbone of the problem. the fraction of backbone  the percentage of variables in the backbone  reflects the constrainedness of the problem and directly affects an algorithm searching for a solution. the larger the backbone  the more tightly constrained the problem becomes. 
   *this research was supported in part by nsf grants iis-1 and itr/eia-1  and in part by darpa cooperative agreements f1-1 and f1-c-1. thanks to sharlee climer for the joint work on an algorithm for finding backbones and 
alan frieze for a question on a bin-ball problem. thanks also to 
sharlee climer  david johnson  scott kirkpatrick and the anonymous reviewers for very helpful comments and suggestions to early versions of the paper. 
모in contrast to numerous phase-transition studies on decision problems  the research on the phase transitions and backbones of optimization problems is limited. an early work on the symmetric traveling salesman problem  which is an optimization problem  introduced the concept of backbones and left an open question of whether there exists a phase transition of the tsp . however  this question has not be addressed since 
1. one of the most rigorous phase-transition results was obtained on number partitioning   an optimization problem. however  the phase transition analyzed was the existence of a perfect partition of a set of integers  which is in essence a decision problem. in our early work  we studied the relationship between the phase transitions of satisfiability  a decision problem  and maximum satisfiability  an optimization problem . in addition  the relationship between backbones and averagecase algorithmic complexity has also been considered . 
모in this paper  we study the phase transitions of the asymmetric traveling salesman problem  tsp   which has many real-world applications such as scheduling and routing. the tsp  1; 1  is an architypical combinatorial optimization problem  and also very often a touchstone for combinatorial algorithms. in this paper  we consider the asymmetric tsp  atsp   where the distance from one city to another may not be necessarily the same as the distance in the reverse direction. the atsp is more general and difficult than the symmetric tsp  stsp . our results provide strong positive evidences to the long-standing open question of   1  using the more general form of the problem. another reason that we choose the atsp rather than the symmetric tsp is that many properties of the assignment problem   a problem closely related to the atsp  are known  section 1  and useful to our analysis. 
모specifically  using random problem instances of up to 1 cities  we empirically reveal that the average optimal tour length  the accuracy of the best cost function  the assignment problem   and the backbone of the atsp undergo sharp phase transitions. the control parameter is the precision of intercity distances which is typically represented by the number of digits for the distances. note that these results are algorithm independent and properties of the problem. furthermore  we show that the average computational cost of the wellknown branch-and-bound subtour elimination algorithm  1; 1  for the atsp exhibits a threshold behavior  in which the computational cost grows abruptly and dramatically as the distance precision increases. 
two related results are worth mentioning. the research in 
 revealed that the average complexity of the subtour elim-

1 	satisfiability 

ination algorithm for the atsp is controlled by the number of distinct intercity distances. we will further extend this result in section 1. however  these results are algorithm specific  which may not necessarily reflect intrinsic features of the underlying problem. the research in  studied the decision version of the symmetric tsp. specifically  it analyzed the probability that a tour of length less than a specific value exists for a random symmetric euclidean tsp  showing that the probability has a one-to-zero phase transition as the length of the targeting tour increases. note that the phase-transition result in   l l   does not address the open question of   1  which is on the optimization version of the problem. 
1 the problem and algorithms 
given n cities and a matrix d =  dlj  that defines the distances or costs of pairs of cities  the traveling salesman problem  tsp  is to find a minimum-cost complete tour visiting each city once. when the cost matrix is asymmetric  i.e.  dij is not necessarily equal to d j i  the problem is the asymmetric tsp  atsp   which is more'difficult than the stsp  for both optimization and approximation . 
모the branch-and-bound  bnb  subtour elimination algorithm  1; 1  solves the atsp using the assignment problem  ap  as a lower-bound cost function. the ap  which can be solved in 1 n1   is to assign to each city i another city j with cost equal to distance d i j  so that the total cost of all such assignments is minimized . if the ap solution happens to be a complete tour  it is also an atsp solution. 
모the bnb search takes the atsp as the root of the state space and solves the ap to the root node. if the ap solution is not a complete tour  decompose it into subproblems by selecting a subtour from the ap solution and generate subproblems by excluding some edges in the subtour to eliminate the subtour. we used the carpaneto-toth subtour-elimination heuristic  in our implementation  which generates no duplicate subproblem  so that the search space is a tree. next  select as the current problem a new subproblem that has been generated but not yet expanded. this process continues until there is no unexpanded problem  or all unexpanded problems have costs greater than or equal to the cost of the best complete tour found so far. 
모our algorithm is  in principle  the same as that of   which is probably the best known complete algorithm for the atsp. the main difference between the two is that we use depth-first branch-and-bound  dfbnb   due to its low space requirement  while  used best-first search. we further extended our dfbnb algorithm to finding all optimal solutions and backbones. 
1 	previous  related results 
two previous lines of work influenced this research and helped reveal the properties of the atsp. 
1 	phase transitions in tree search 
to capture the tree search of the dfbnb algorithm for the atsp  we first introduce an abstract tree model. an incremental tree  1; 1; 1   t m  d   is a tree with depth dy and independent and identically distributed  i.i.d.  random branching factors with mean m. edges are assigned costs that are finite and nonnegative i.i.d. variables. the cost of a node is the sum of the edge costs along the path from the root to that node. an edge cost is nothing but the difference between a node cost and the cost of its parent. an optimal goal is a node of minimum cost at depth the overall goal is to find an optimal goal node. 
모let  be the probability of a node having the same cost as its parent. the expected number of child nodes of a node that have the same cost as their parent is mpo- the following results have been proven  1; 1; 1 . let be the expected optimal goal cost of t m d  with m 1. let nbfs and ndfs be the expected numbers of nodes expanded by bestfirst search and dfbnb  respectively. 
q1 and nbfs = ndfs - 	almost surely when mpo   
1  where a1 and a1 are constants;  1  
and 	= a n d ndfs 	= a l m o s t surely when 
= 1;  1  c* remains bounded by a constant and = and ndfs = almost surely when  
모the above results mean that the cost of an optimal goal node almost surely undergoes a phase transition from a linear function of depth d to a constant when  increases beyond one. meanwhile  the expected complexity of best-first search and 
dfbnb changes dramatically from exponential to polynomial in d as mpo is reduced below one. 
1 	relationship between ap and atsp 
the assignment problem  ap  cost function and its relationship with the atsp have been a research interest for a long time  1; 1; 1; 1 . the relationship between the ap cost  ap d   and the atsp cost  atsp d   has remarkably different characteristics under different distance distributions of a random matrix d. the ap d  and atsp{d  can be the same with a high probability  or they can differ from each other  with a high probability  by a function of n. if the expected number of zeros in a row of d approaches infinity when 
ap d  = atsp{d  with a probability tending to one . however  if the distances are uniform over 
ap d  = atsp d  with a probability going to zero  where  grows to infinity with n . indeed  when the entities of d are uniform over  1   e atsp d  - ap d   where co is a positive constant . 
1 	phase transitions of the atsp 
the results in the previous section indicate that the quality of the ap function varies significantly  depending on the underlying distance distribution. precisely  the difference between the ap cost  ap d   and the atsp cost  atsp d  has two phases  controlled by the number of zero distances in the distance matrix d. in one phase  the difference is zero with high probability  while in the other phase  the expectation of the difference is a function of the problem size n. 
모how does the difference between atsp d  and ap d  change phases  does it have a sharp phase transition  or does it follow a slow process  do other properties of the atsp  such as the backbone  also have phase transitions  
모the two-phase result on the accuracy of the ap cost function discussed in section 1 is in principle consistent with the phase-transition result of incremental random trees in section 1. the root of the search tree has a cost equal to the ap cost ap d  to the problem and an optimal goal node has the atsp tour cost atsp{d . if we subtract the ap cost to the root from every node in the atsp search tree  the root node has cost zero and an optimal goal node has cost equal to atsp d  - ap d . when there are a large number of zero distances in d  the ap cost of a child node in a search tree is 

more likely to be the same as the ap cost of its parent  since ap will tend to use the zero distances. therefore  it is expected that more nodes in the search tree will have more than one child node having the same cost as their parents. in fact  the concept of zero distances can be extended to minimal-cost distances. if the cost of the minimal distance is known  we can simply subtract it from every distance without affecting the accuracy of the ap function. 
1 	the control parameter 
furthermore  the concept and role of zero and minimal distances can be extended to that of equal distances. the ap to a child node is obtained by excluding one arc  and possibly including some arcs  of a subtour of the ap solution to the parent node. with this new restriction  the child ap is then computed by constructing a new augmenting path from the starting point to the end point of the excluded arc . the child and parent ap solutions usually differ by only a relatively small number of arcs. in other words  the child ap solution is derived by replacing some arcs in the parent ap solution. if the numbers of distances of equal values are large  it is more likely that the child ap cost is equal to the parent ap cost. conversely  when the number of distinct distances is large  it is unlikely the costs of two aps will be the same. when the distances are uniform over  1         r - 1   the probability that the child ap cost is equal to the parent ap cost will depend on the range jr. if r is small  relative to the problem size n  this probability will be high. in short  for a given problem size  the accuracy of the ap cost function is controlled by the number of distinct distances in matrix d. more precisely  the accuracy of the ap is determined by the fraction  denoted as  of distinct distances. 
모in practice  however  we do not directly control the number or the fraction of distinct distances. in addition to the actual structures of the  layouts  of the cities  the precision of the distances also affects the number of distinct distances. the precision of a number is usually represented by the maximal number of digits allowed for the number. as a result  the number of digits for distances is naturally a good choice for the control parameter. 
모the effect of a given number of digits on the fraction of distinct distances is relative to the problem size n. consider a 
matrix d with distances uniformly over where the range r is determined by the number of digits b. for a fixed b1 the fraction of distinct distances of a larger matrix d is obviously smaller than that of a smaller d. thus  the control parameter for the fraction of distinct distances must be in the form of where f n  is a rescaling function on the effect of the number of digits. 
모to find the scaling function  consider the number of distinct distances of matrix d for a given integer range r. the problem of finding the number of distinct distances is equivalent to the bin-ball problem as follows. we are given m balls and r bins  and asked to place the balls into the bins. each ball is independently put into one of the bins with an equal probability. we are interested in the fraction of bins that are not empty after all the placements. here  for asymmetric tsp m = n1 - n balls correspond to the total number of nondiagonal distances of matrix d  and r bins represent the possible integers to be selected from. since each ball  distance  is thrown independently and uniformly into one of r bins  integers   the probability that one bin is not empty after throwing 

모controlled by the effective number of digits the fraction of distinct distances has a phase transition of its own  also shown in figure 1 a . the larger the problem  the sharper the transition  and there exists a crossover point among the transitions of problems with different sizes. we can examine the phase transitions more closely using finitesize scaling. finite-size scaling  is a method that has been successfully applied to phase transitions in similar systems of different sizes. based on finite-size scaling  around a critical parameter  temperature   problems of different sizes tend to be indistinguishable except for a change of scale given by a power law in a characteristic length. thus  finite-size scaling can help to characterize a phase transition precisely around a critical point of the control parameter as the problem scales to infinity. for the problem at hand  the effective 

1 	satisfiability 

bounds represent the 1% confidence intervals. the rescaled phase transitions are shown in figure 1 b . 
모note that the number of digits used for intercity distances is nothing but a measurement of the precision of the distances. the larger the number of digits  the higher the precision becomes. this agrees with the common practice of using more effective digits to gain precision. therefore  the phase transition of the control parameter is in turn determined by the precision of intercity distances. 
1 	phase transitions 
with the control parameter  the effective number of digits for intercity distances  identified  we are now in a po-
sition to investigate possible phase transitions in  1  the atsp cost   1  the probability that an ap cost is equal to the corresponding atsp cost   1  the relative error or accuracy of the ap lower-bound function  and finally  1  the backbone of the atsp. the answers to the first three problems provides a detailed picture on the accuracy of the ap cost function  and the answer to the last problem reveals the intrinsic constrainedness among the cities as the precision of distances changes. we examine these four problems in turn. 
we generated uniformly random problem instances of 1-  
1-  1- to 1-cities and 1-cities. intercity distances are independently and uniformly chosen from {1 1         r1} for a given range r  which is controlled by the number of digits 1. we varied 1  with an increment of 1  from 1 to 1 for instances with up to 1-cities and from 1 to 1 for instances with 1-cities. for each combination of and we generated 1 instances for problems  l - 1  listed above  and 1 instances for problem  1  due to its high computational cost. to make the result figures readable  we only use the curves from 1-  1-  1- and 1-city problems. 
모there is a phase transition in the atsp tour cost  atsp d   shown in figure 1 a . the reported tour costs are obtained by dividing the integer tour costs from the dfbnb algorithm by n x  r - 1   where n is the number of cities and r figure 1:  a  average accuracy of ap lower-bound function  measured by the error of ap cost relative to atsp cost   b  normalized average accuracy. 
the range of intercity costs. equivalently  an intercity distance was virtually converted to a real value in  1 . by doing this  we can verify the existing analytical result on the ap and atsp costs. this will be discussed in detail in the next subsection. 
모as shown  the atsp tour cost increases abruptly and dramatically as the effective number of digits increases  exhibiting phase transitions. the transitions become sharper as the problem becomes larger  and there exist crossover points among curves from different problem sizes. by finite-size scaling  we further determine the critical value of the control parameter at which the phase transitions occur. the scaled result is shown in figure 1 b . it is worthwhile to mention that the ap cost  not shown  follows almost the same phase-transition pattern. 
모our numerical results show that when the number of digits for intercity distances is very small  for example  less than 1 digits or r  1 for n = 1  the ap and atsp costs are equal to zero  meaning that these two costs are the same as well. given a random distance matrix d  how likely is it that an ap cost will differ from the atsp tour cost as the effective number of digits  increases  we address this question by examining the probability that an ap cost ap d  is equal to the corresponding atsp cost atsp d  as b increases. figure 1 a  shows the results  averaged over the same set of instances for figure 1. as shown  the probability that ap d  = atsp d  also experiences phase transitions. figure 1 b  shows the phase transitions after finite-size scaling. 
모the results in figure 1 also imply that the quality of the ap function degrades as the effective number of digits increases. the degradation also follows a phase-transition process. this is verified by figure 1  using the data from the same set of 


n digits | 	ap cost atsp cost relative ap error  %  1 1 1p.11 k 1  1 1 1  1. m 1 1 1 1 1 1  1 1  1 1 1 1 1 1 1 1  1 1 1 1 1 1  1 1  1 1 1 1  1 1 1 1  1 table 1: results on ap cost  the atsp cost and ap error relative to the atsp cost  on random atsp. each datum is averaged of 1 instances. all error bounds represent 1 percent confidence intervals. 
problem instances for the previous two figures. 
모we now turn to the backbone of the atsp  which is the fraction of directed arcs that appear in all optimal solutions. the backbones also exhibit phase transitions as the effective number of digits for distances increases. the result is included in figure 1. interestingly  the phase-transition pattern of the backbone is almost identical to that of the fraction of distinct entities in the distance matrix  shown in figure 1  and that of the atsp tour cost  shown in figure 1. 
모the fraction of backbone captures  in essence  the tightness of the constraints among the cities. as more intercity distances become distinct  the number of tours of unique lengths increases. consequently  the number of optimal solutions decreases and the fraction of backbone grows inversely. when more arcs are part of the backbone  optimal solutions become more restricted and the number of optimal solutions decreases  making it more difficult to find an optimal solution. 
1 	asymptotic ap precision 
as a by-product of the phase-transition results  we now provide asymptotic values of the atsp cost  the ap cost and its accuracy. we attempt to extend the previous theoretical results on the ap cost  which is known to be within  1 1    and the observation that the accuracy of the ap lower bounds increases as the problem size increases . 
모we need to be cautious in selecting the number of digits for intercity distances. as discussed earlier  the same number of digits for distances gives rise to different effective numbers of digits on problems of different sizes. therefore  the number of digits must be scaled properly to have the same effect on problems of different sizes when we exam an asymptotic feature. 
모therefore  in our experiments  we fixed the scaled effective number of digits  to a constant. based on the phasetransition of the control parameter in figure 1  we took = 
 a constant of 1. 	= 1 is suf-
1 
ficiently large so that all distances are distinct  regardless of problem size  and the quantities to be examined do not change substantially after finite-size scaling.  = 1 is also relatively small so that we can experiment on large problems. in our implementation of the dfbnb algorithm  distances are integers of 1 bytes. thus the number of digits must be less than 1 without causing an overflow in the worst case. using  = 1  we can go up to roughly 1-city atsps in the worst case. 
모table 1 shows the results  with up to 1 cities. the ap cost approaches to 1 and the atsp cost to 1. the accuracy of ap function indeed improves as the problem size increases  with relative error reduced to about  for 1-city problems. 
1 threshold behavior of subtour elimination 
the phase-transition results indicate that the atsp becomes more constrained and difficult as the distance precision becomes higher. we now study how the dfbnb subtour elimination algorithm behaves. we separate this issue from the phase transitions studied before because we now consider the behavior of a particular algorithm  which may not be necessarily a feature of the underlying problem. nevertheless  this is still an issue of its own interest because this algorithm is among the best known methods for the atsp  and we hope that a better understanding of this algorithm can shed light on the typical case complexity of the problem. 
모figure 1 a  shows the average complexity of the dfbnb algorithm  measured by the number of calls to the ap function. the result is averaged over the same problem instances for each data point as used for the phase transitions in the previous section. note that the number of ap calls increases significantly from small problems to large ones using the same effective number of digits for distances. thus  we normalize the result in such a way that for a given problem size  the minimal and maximal ap calls among all problem instances of the same size are mapped to zero and one  respectively  and the other ap calls are proportionally adjusted to a ratio between 1 and 1. this allows us to compare the results from different problem sizes on one figure. the curves in figure 1 a  follow a pattern similar to that of the phase transitions in the previous section. the complexity of the subtour elimination algorithm increases with the effective number of digits  and exhibits a threshold behavior similar to phase transitions. indeed  we can use finite-size scaling to capture the behavior as the problem size grows  as illustrated in figure 1 b . the results in figure 1 and the results in the previous section indicate that the complexity of the subtour elimination algorithm goes hand-inhand with the constrainedness of the problem. 
모similar results have been reported in . the results of this subsection extend that in  to different sizes of problems and by applying finite-size scaling to capture the threshold behavior as problem size increases. 
1 conclusions and discussions 
our main contributions are twofold. first  we provided strong positive evidences to the long-standing question of whether the traveling salesman problem  tsp  has phase transitions . 
we studied this issue on the more general asymmetric tsp  atsp . we empirically showed that many properties  including the atsp tour cost and the fraction of backbone  have 
satisfiability 

two characteristically different values  and the transitions between them are rather abrupt and dramatic  displaying phasetransition phenomena. the control parameter of the phase transitions is the effective number of digits representing the intercity distances  which in essence measures the precision of distances. our results revealed the connection between distance precision and phase transition properties in the atsp. distance precision is the control parameter for various phase transitions of the atsp. we believe that the concept of precision determining problem properties such as phase transitions is rather universal and may very well be applicable to other problems  including various scheduling and planning problems. 
   second  our phase transitions results provide a practical guidance to how to generate difficult random atsp problem instances and which instances to use to compare the asymptotic performance of two algorithms. a common practice in comparing algorithms when using a random ensemble is to generate problems with a fixed distance precision. our results imply that the correct way is to use problem instances of different sizes that have the same or similar features such as the same fraction of backbones. this  in turn  requires to increase the number of digits for intercity distances as the problem size grows. we believe that this guidance is general and can be applied to other optimization problems. 
