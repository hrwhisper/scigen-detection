we present lungcad  a computer aided diagnosis  cad  system that employs a classification algorithm for detecting solid pulmonary nodules from ct thorax studies. we briefly describe some of the machine learning techniques developed to overcome the real world challenges in this medical domain. the most significant hurdle in transitioning from a machine learning research prototype that performs well on an in-house dataset into a clinically deployable system  is the requirement that the cad system be tested in a clinical trial. we describe the clinical trial in which lungcad was tested: a large scale multi-reader  multi-case  mrmc  retrospective observational study to evaluate the effect of cad in clinical practice for detecting solid pulmonary nodules from ct thorax studies. the clinical trial demonstrates that every radiologist that participated in the trial had a significantly greater accuracy with lungcad  both for detecting nodules and identifying potentially actionable nodules; this  along with other findings from the trial  has resulted in fda approval for lungcad in late 1.
categories and subject descriptors
i.1.m  pattern recognition : miscellaneous
general terms
algorithms
keywords
computer aided detection  lung cancer prognosis  classification  clinical trial
1. introduction
　lung cancer is the most commonly diagnosed cancer worldwide  accounting for 1 million new cases annually. lung
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. to copy otherwise  to republish  to post on servers or to redistribute to lists  requires prior specific permission and/or a fee.
kdd'1  august 1  1  san jose  california  usa. copyright 1 acm 1-1-1/1 ...$1.
cancer is an exceptionally deadly disease: 1 out of 1 people will die within one year of being diagnosed. the expected 1-year survival rate for all patients with a diagnosis of lung cancer is only 1%  compared to 1% for colon  1% for breast and 1% for prostate cancer. in the united states  lung cancer is the leading cause of cancer death for both men and women  causing more deaths than the next three most common cancers combined  and costs $1 billion to treat annually. however  lung cancer prognosis varies greatly depending on how early the disease is diagnosed; as with all cancers  early detection provides the best prognosis. at one extreme are the patients diagnosed with metastatic tumors  that have spread far from the lung   for whom the 1-year survival rate is just 1%. on the other hand  when diagnosed at an early stage  when the disease is still localized within the lung  the 1-year survival rate is 1%  and many treatment options  surgery  radiotherapy  chemotherapy  are viable. today  only 1% of lung cancer cases are diagnosed at an early stage.  1  1 .
　the recent development of multidetector computed tomography  mdct  scanners has made it feasible to detect lung cancer at very early stages in priciple. despite these advances in technology  many potentially clinically significant lesions still remain undetected . one contributing factor is the explosion of generated data: the state-of-the-art 1slice dual-source ct acquires up to 1 axial images in 1 seconds for each patient  each image must then be carefully examined by a radiologist . there is a growing consensus among clinical experts that the use of computer-aided diagnosis  cad  software when used as a second reader  i.e.  in conjunction with the radiologist  not only offers the potential to improve the detection accuracy of a radiologist  but also to reduce mistakes related to misinterpretation  1  1 . in order for a cad system to be used in clinical practice in the united states  it must first receive approval from the the food and drug administration  fda . all cad systems must go through a rigorous clinical trial to receive approval  in much the same way as a new drug . a handful of cad systems have received approval for detecting breast cancer lesions in the past 1 years. to be approved cad systems must show satisfactory performance in two areas. the principal value of cad is determined not by its stand-alone performance  but rather by carefully measuring the incremental value of using computer-aided diagnosis in normal clinical practice with the radiologist in-the-loop. secondly  cad systems must not have a negative impact on patient
industrial and government track short paper
management  for instance  false positives which cause the radiologist to recommend unnecessary  and potentially dangerous  follow-ups . additionally  designing a trial for lung cancer detection is considerably more challenging than for breast cancer. one factor is the relative difficulty in obtaining ground truth  correct labeling  for lung cancer related lesions. whereas  in breast cancer virtually all suspicious lesions are routinely biopsied  providing definitive histological ground truth   a lung biopsy is a dangerous procedure  with a 1% risk of serious complications  including death ; this makes obtaining definitive ground truth infeasible  particularly for patients being evaluated for early signs of lung cancer.
　section 1 describes some of the machine learning challenges involved in learning a classifier for detecting lung cancer. we review some of our previous solutions. section 1 describes the clinical trial design for our lungcad system  which includes a fairly complex mechanism for determining ground truth and measuring incremental improvement. section 1 summarizes the experimental results of the clinical trial that has resulted in granting clinical approval for lungcad. we conclude in section 1 with some discussion about cad in general and future challenges.
1. machine learning challenges
　lungcad system consists of 1 stages: 1. lung segmentation to identify the lung area within the chest; 1. candidate generation which identifies suspicious unhealthy candidate regions of interest  roi  from a medical image; 1. feature extraction that computes descriptive features for each candidate so that each candidate is represented by a vector x of numerical values or attributes ; 1. classification that differentiates candidates based on candidate feature vectors; 1. visual presentation of cad findings to the radiologist in order for him to accept or reject the cad findings. in this section  we focus on learning the classifier in step 1.
　automatic learning technologies greatly reduce the time required to develop algorithms that act as  second readers  besides improving the diagnostic accuracy. many standard algorithms  such as support vector machines  svm   backpropagation neural nets  kernel fisher discriminants  have been used to learn classifiers for detecting malignant structures  1  1 . however  these general-purpose learning methods either make implicit assumptions that are commonly violated in cad applications  or cannot effectively address the difficulties arisen when learning a cad system.
　non-iid data traditional learning methods almost universally assume that the training samples are independently drawn from an identical albeit unobservable underlying distribution  the iid assumption   which is often not the case in cad systems. due to spatial adjacency of the regions identified by a candidate generator  both the features and the class labels of several adjacent candidates are highly correlated. this is true both in the training set and in the testing data. a batch-classification algorithm in  derives a probabilistic classification model by specifying a priori guess on the candidate labels with a covariance matrix Σ that encodes the spatial-proximity-based correlations within an image. multiple-instance learning methods  1  1  optimize the classifier design by taking into account the fact that multiple candidates can exist to associate with a single malignant structure. random effects may exist in patient images from the same hospital  or exist in different candidates extracted from the same patient. the approach in  proposes to use additional mix-effect parameters  each for one hospital  or for one patient. all these algorithms improve the classification accuracy significantly.
　unbalanced data and speed in the candidate identification stage  high sensitivity  ideally close to 1%  is essential  because any cancers missed at this stage can never be found by the cad system  which potentially produces many false positives  less than 1% of the candidates are positive   making the classification problem highly unbalanced. moreover  a cad system has to satisfy real-time requirements that it finishes running during the radiologists first read. these issues were addressed by employing effective cascaded classification frameworks as shown in  1  1 . the method in  investigates a cascaded classification approach that solves a sequence of linear programs  each constructing a sparse hyperplane  linear  classifier. it incorporates the computational complexity of various features into the cascade design for time efficiency. a more recent work  does not follow standard cascade procedure where individual classifiers are optimized towards one specific stage given the candidates survived from early stages. instead  it uses a novel and-or cascade training strategy which optimizes all of the classifiers in the cascade in parallel by minimizing the regularized risk of the entire system and providing implicit mutual feedback to individual classifiers to adjust parameter design. these cascaded approaches have been compared with the well-known cascade adaboost  and are superior with many additional advantages.
　irrelevant and redundant features when searching for descriptive features  researchers often deploy a large amount of experimental image features to describe the identified candidates  which consequently introduces irrelevant and redundant features. feature selection is essential in cad systems. a previous lungcad system  utilizes a greedy forward selection approach to select one feature at one time from the feature set according to certain discriminant score ranking. recent research has focused more on general sparsity treatments to construct sparse estimates of classifier parameters  such as in  1  1 . these models control the classifier complexity by sparse-favoring regularizationp terms  such as the `1-norm regularization ||w||1 = |wi| for a linear classifier of the form sign wtx .
1. lungcad trial design
　the clinical trial design is illustrated in figure 1. the principal challenges we faced in designing the clinical trial are described below:
measure incremental improvement: the principal value of cad is determined not by its stand-alone performance  but rather by carefully measuring the incremental value of computer-aided diagnosis in normal clinical practice; as reflected in incremental improvement in accuracy as objective evaluation by the radiologist.
patient management impact: it is not enough that lungcad improves the detection of lung cancer. it must result in a net improvement in patient management since unnecessary false positive findings lead to unnecessary follow-ups. ground truth: as discussed earlier  due to the unavailability of lung biopsies   an alternative method had to be devised for determining ground truth.

figure 1: a multicenter  multi-reader multi-case  mrmc  retrospective clinical study to assess the incremental value of lungcad in the identification of pulmonary nodules on thoracic ct examinations  cro= contract research organization  gr=general radiologist  cr=chest radiologist .　we retrospectively collected mdct studies from 1 consecutive patients  mean age: 1y  1% male  who had been referred for evaluation of potential pulmonary nodules from 1 clinical sites: nyu  univ. of pennsylvania  univ. of maryland and the cleveland clinic; these studies were processed by an independent contract research organization  cro   bioimaging  inc  yardley pa. 1 studies were excluded due to respiratory or cardiac motion  or image artifacts.
　all 1 studies were initially evaluated by 1 board-certified general radiologists  gr  in active community practice  each using a predetermined randomized order  to detect potential nodules of diameter − 1mm. the gr's were required to score potential nodules on a  nodule  scale  from 1   unlikely   to 1   definite  . gr's were also required to determine if each nodule could be identified as  actionable  again on a 1 point scale  1   1 denoting  no followup needed   1  indeterminate     1  definite need for followup  . to illustrate  a benign calcified granuloma would be represented as true  1   non-actionable    1  nodule.
　then cad-identified potential nodules were presented to the gr's  after eliminating nodules that had already been found by the gr   and were assessed using the same two scales. these blinded  independent reviews were re-sent to the cro  where findings were examined by an independent fellowship trained chest radiologist to consolidate any nodules independently found by more than one gr.
　the results were then reviewed separately by 1 fellowshiptrained expert chest radiologists  cr  randomly chosen from a panel of 1  each interpreting 1 studies. expert cr's were required to evaluate each nodule separately without knowledge of whether these had been identified by radiologists or by cad  and to assess them on both a  nodule  and  actionability  binary decision and its rating. further  the nodule size and lung lobe in which each nodule was seen was also recorded. for nodule candidates to be considered true nodules  ground truth  a minimum consensus of 1 out of 1 experts was necessary.
a note on sample size: based on pilot studies  we assumed that at least 1% of patients would have a nodule in an average of 1 lobes  that the cr's would have average roc area without cad of 1 with moderate inter-reader variability  and that cad would improve the roc area by 1. to yield 1% power in the trial  we estimated that 1 readers and 1 patients would suffice.
1. clinical trial results
　ground truth was defined as having at least 1 of 1 expert chest radiologists identifying at least one nodule in a lobe  affected lobe ; otherwise  lobes were labeled normal. similarly  an actionable lobe was one in which 1 or more cr's identified one or more actionable nodules.
　a total of 1  − 1mm  nodules were identified in 1 patients of which 1  1%  were interpreted by expert cr's as actionable.  unless specified otherwise  from here on all nodules will be assumed to be in the clinically relevant range of − 1mm in diameter.  1 patients had at least 1 nodule  prevalence rate of 1% : only 1 patients were interpreted as normal  all lobes were normal . 1 nodules were detected in 1  1%  of 1  = 1〜1  potentially evaluable lobes of which 1  1%  had at least one actionable nodules.
　the primary measurement for the diagnostic accuracy of the 1 general radiologists  gr   both with and without cad  for detecting solid pulmonary nodules  is the area under roc curve  using lobes as the unit of analysis. a nonparametric estimator was used to adjust for the clustered data as described in . sensitivity was defined as the probability that a gr identified at least one nodule in an affected lobe; specificity was defined as the probability that a gr did not identify a nodule in a normal lobe  i.e.  correctly identified it as nodule-free .
　figure 1 shows that the 1 gr's accuracy for identifying nodules ranged from 1 to 1 without cad to
industrial and government track short paper

figure 1: area under receiver operating curve with and without cad  for actionable solid nodules.

figure 1: average nonparametric roc curve of all 1 readers for detecting nodules without and with cad.
1 to 1 with cad. the most important result was that every one of the 1 gr's had statistically significantly greater accuracy with cad for detecting lung nodules. assessed collectively  the gr's mean accuracies were 1 and 1  without and with cad  respectively  p   1; 1% ci of 1 to 1   as shown in figure 1.
　similar results were achieved for the clinically significant actionable nodules: the 1 gr's accuracy for ranged from 1 to 1 without cad to 1 to 1 with cad. again  every one of the 1 gr's had statistically significantly greater accuracy with cad for identifying actionable lung nodules.we stress these findings because most cad trials demonstrate a statistically significant increase for the readers considered as a group  with only some of the readers individually having statistically significantly greater accuracy. these results are particularly significant because every gr showed statistically significant improvement for both tasks detecting nodules  and identifying actionable nodules. fig-

figure 1: average nonparametric roc curve of all 1 readers without and with cad for identifying actionable nodules.
ure 1 shows the roc performance for all 1 readers without and with cad for identifying actionable nodules.
　we varied the definition of expert truth by changing the number of expert confirmations required for acceptance from any 1 cr to 1  1  1  1 expert cr's for both nodules and actionable nodules. with one exception  every one of the 1 gr's showed statistically significant improvement both for detection and identification of actionable nodules with cad.  the sole exception was the case that all 1 expert cr's must agree about an actionable nodule - which tended to happen for fewer and more obvious actionable nodules  thus making it harder to shown statistically significant improvement  but the trend was towards improvement with cad.  in another analysis  statistical improvement in gr's accuracy was achieved for all nodules regardless of size  − 1mm .
　to determine the patient management impact we estimated the number of patients  where cad lead to a positive management change: i.e.  a recommendation for additional imaging studies and/or biopsy in an actionable lobe which was missed without cad ; and estimated the number of patients where cad lead to a negative management change: a recommendation for additional studies and/or biopsy in a normal lobe which was correctly diagnosed without cad. as this is a patient-level analysis  patients with both positive and negative management changes were labelled as a positive change  under the assumption that detecting a missed nodule is more beneficial to a patient than the risk of an unnecessary follow-up  typically another imaging exam .
　the average number of patients with a positive management change resulting from using cad was 1  averaged across the cr's   meaning that 1 patients  = 1.1  must be evaluated for a positive management change  on average. on the other hand  1 patients had negative management changes  averages across the 1 cr's   meaning that 1 patients must be evaluated with cad for a negative management change to result. as the positive management changes exceeded the negative management changes on average  this was sufficient  even without considering that on average positive management changes are more beneficial than negative managment changes are harmful.
　additional details on the multi-reader  multi-case  mrmc  statistical methodology used  are provided in our submission and in . the lungcad clinical trial summary of safety and effectiveness   which is available on the fda's web site  contains many more results and analyses  including: patient-level analysis of gr's increase in accuracy with cad  bootstrap sampling to estimate variability of expert cr's.
1. discussion
　to summarize our clinical results  cad is an effective second reader  both for detecting nodules and for identifying potentially actionable nodules. the false positive rate is acceptably low given the increased rate of positive management changes. these findings have resulted in lungcad being granted clinical approval by the fda for detecting solid pulmonary nodules from ct thorax studies. although some debate remains about the precise value of screening  for breast cancer  and now for lung cancer   all experts agree that early detection is key for improvement of cancer cure rates. many efforts are ongoing to pave the way for mdct to be used for identifying lung cancer at early stages. however  much remains to be done in this area. first  our study focused on solid pulmonary nodules; in high risk patients  part-solid and ground-glass nodules  ggn  are also seen on chest mdcts. ggns are defined as nodules with hazy attenuation without obscuration of underlying vascular markings  and will necessitate the development of improved machine learning and image processing methods to detect.
　our focus in this study been to detect pulmonary nodules. however  the eventual goal is not just to detect nodules  or even to detect actionable nodules  but to detect lung cancer in early stages  and thereby  intervene and treat the patient and improve survival. therefore  cad needs to move in the next few years  from detecting nodules to classifying nodules as benign or malignant. a first step could be to report the probability of malignancy  although the clinical and regulatory challenges to design a trial to prove the efficacy of such a system would be daunting  larger sample size is not the answer - our study took nearly two years to complete and the fda is already taking steps to reduce the regulatory burden  while ensuring the safety and efficacy of cad . an even more intriguing notion would be to identify lesions that are currently benign  but would have a high probability of turning malignant - pre-cancerous lesions - to move from a reactive paradigm of treating cancer to a more proactive paradigm of prevention.
　we have described some machine learning challenges in the lung cad domain and reviewed some of our previous machine learning work. our methods are not specific to lung cancer only  and have shown equivalent or superior performance on other data sets. for instance  the pecad  pulmonary embolism  problem  that formed the basis of the 1 kddcup  is very different in its evaluation criteria; treatment of pe is systemic  as opposed to localized in lung cancer  and the goal is to identify patients as having one of more pe's or being pe-free. in the coloncad problem  the goal is to detect all pre-cancerous polyps; the cost of a false positive is not very high  and the treatment of choice is to remove all potentially suspicious lesions. yet  despite the very different optimization criteria and the vastly different medical domain knowledge  many of these machine learning methods described here  also translate to these and other cad problems.
