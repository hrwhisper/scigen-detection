in this paper  we propose a web-based system for prevention of the confidential information leakage caused by the person who is authorized to access. this system realizes the centralized access control to the distributed confidential information and supports the confidential pages generated dynamically by web applications. we show the design and implementation of this system that is transparent to users. 
keywords 
web  security  information protection 
1. introduction 
as the internet technology has become essential to office works  the office staff might deal with the confidential information such as customer information  personnel information  and designs of new products over the organization network. however  many incidents of confidential information leakage occur in organizations and most of these incidents are caused by the internal staff. information leakage is one of the most serious security threats to the information security  but there are few effective methods to prevent it comparing with other conventional security threats such as eavesdropping of the network traffic. 
in this paper  we propose the data leakage prevention  dlp  system. this system provides protection of the confidential information stored in the web server against the information leakage such as bringing out the data by saving it as file  writing it to the media  and printing it out. users can only read but cannot copy nor print the confidential information. the dlp system comprises four major components; viewer  encryption proxy  authentication server  and access control directory. encryption proxy  which is a proxy server interposed between client and web server  encrypts transmitted data of the confidential information on demand. adopting this encryption method  it is not necessary to change the existing web server that stores the confidential information  and the dlp system supports the confidential information generated dynamically by web applications such as cgi or java servlet. in addition  whenever viewer accesses the confidential information  authentication server authenticates users and controls the access. the system administrator can manage the confidential information with the configuration of access control directory and centralized access control of the distributed confidential information can be realized.  
1. architecture 
we precise the architecture of the dlp system  figure 1 . web server  encryption proxy  access control directory and authentication server are located in the separated network segment so that no one can access them directly. furthermore  those components authenticate each other and the communications among them are secure. no one can access those components without being authorized.  
the web server stores confidential pages in plain form. encryption proxy is placed between the client and the web server to prevent the client from accessing to the web server directly via the network. it authenticates access users and encrypts the requested confidential page with the corresponding content key that is a secret key for encryption and stored in access control directory. viewer is installed in the client  which is an application to display confidential pages in this system. while viewer is running  the user can neither take screen capture nor copy the displayed confidential information. viewer has a function to save the encrypted confidential page. 

 
 	figure 1. system architecture of the dlp system. 
 
access control directory is the database in which administrator registers the following tables; user table and secret data table. the user table records user accounts and passwords. the secret data table records data descriptors  confidential page urls  content keys to encipher and decipher the confidential pages  and access control lists. the user table is used in user authentication process. to check the access permission to each confidential page  the system uses the secret data table. when the user opens a confidential page with viewer  it requests the content key of the confidential page to authentication server. authentication server queries access control list and checks permission of the corresponding confidential page to access control directory with id  password and data descriptor  which identifies the confidential page. 
in order to control the access to the distributed confidential information  we design the dynamics of the dlp system that is composed of two phases; download phase and open data phase. the download phase occurs when the web browser sends a request for a secret page stored in the web server to encryption proxy  figure 1 .  

 	figure 1. download phase of the system dynamics. 
 
in the first step  the web browser sends http request for a confidential page to encryption proxy. encryption proxy analyzes the http request and queries access control directory if the request is for the confidential page or not. if the request is for confidential page  encryption proxy downloads it from the web server and encrypts it with the content key stored in the access control directory. after that  encryption proxy adds data descriptor to the encrypted data and sends it to the web browser. in this phase  user cannot see the confidential pages because they are encrypted and stored in the local client. hence  viewer needs to obtain the content key to decrypt and display the downloaded confidential page. 
open data phase is occurred when viewer opens confidential pages encrypted and stored in the local client  figure 1 . at first  viewer sends id  password  and data descriptor to authentication sever. after receiving those data  authentication server queries access control directory in terms of id  password  and data descriptor whether the user may access the confidential page or not. if user is allowed to see the data  authentication server sends content key to viewer. viewer decrypts confidential page data with the received key and displays it.  
 

 	1: decrypt data 	1: authentication
 	figure 1. open data phase of the system dynamics. 
the most important process of the system dynamics is the two-way authentication between viewer and authentication server. actually  the result of user authentication is transmitted to viewer precisely on the basis of the two-way authentication of those two components. therefore  it is necessary for viewer and authentication server to authenticate each other before the beginning of the session by authentication process such as the ssl mutual authentication. applying this protocol  confidential page publisher can control the access to the distributed secret web pages  because users have to be authenticated and given access permission by authentication server whenever they open the confidential page with viewer. 
1. design and implementation 
we built the prototype of the dlp system. the design concept of the prototype is transparency to users  no change in urls and browser behavior . viewer is implemented as activex control so that viewer is embedded into internet explorer and the user is unaware of its running. if a component of frame page is a confidential page  viewer control displays only a part of frame page as a confidential page on internet explorer. it restricts copy and print functions to prevent users from bring out the displayed confidential information. 
viewer control prohibits screen capture while it is running. to realize the prohibition of screen capture  it hooks and cancels the win1 api methods by which capture tools take hardcopies. we can use the techniques to inject an arbitrary dll into another process  to hook the win1 api methods. using dll injection technique  it is possible to manipulate the import section defined in each application and hook the win1 api used in it. however  if the attacker could overwrite the import section of a capture tool after the injection of hooking dll  it is possible to avoid the hooking routine and cancel the win1 api hook. this is the imperative problem. 
the prototype of encryption proxy is the modified squid proxy  to which we added the authentication function as plug-in of the squid. on the arrival of the http request issued by internet explorer  the encryption proxy analyzes the proxy-authentication attribute in the http header field to authenticate the access user and returns a web page for internet explorer to activate viewer control. confidential pages' urls and user accounts are previously registered in the access control directory and the encryption proxy queries it with ldap. 
1. related works 
ibm research proposes a system for web content protection . this system provides digital rights management to off-the-shelf web browsers and browser plug-ins. it verifies the browser code with the digital signature scheme and prevents users from performing actions that are not allowed such as print  save as  and so on. it distinguishes the protected contents with the specific protocol  and internet explorer invokes the trusted control handler with these method names. therefore  it is necessary to change the existing web pages to introduce this system. in addition  usage rights information is stored in the client and there is no mechanism to change the usage rights dynamically. 
1. conclusion 
we proposed the dlp system that realizes the protection of confidential information. by the application of the super-distribution system architecture  to the dlp system  it realizes the access control of the confidential informa- tion after its distribution. furthermore  the on-demand encryption in the proxy realizes the support of confidential pages generated dynamically by web applications. we think that the dlp system is the essential architecture to deal with confidential pages and brings large effects to securities of the web system on the business. 
1. acknowledgements 
we would like to thank tsutomu matsumoto  professor of yokohama national university  for helpful comments and discussions on design and evaluation of the dlp system. 
