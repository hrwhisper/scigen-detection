 
     the internet will never reach its full potential as an electronic marketplace unless e-commerce agents  or proactive web programs  are used to automatically or semi-automatically perform e-commerce tasks. the dynamic and heterogeneous interactions among them and the automations brought by them will create tremendous opportunities as well as introduce the risk and vulnerability for e-commerce. in this paper  we study the security issues with respect to an important multi-agent interaction - the multi-agent coalition formation where e-commerce agents dynamically forming coalitions to exploit the benefits of grouping.  we propose a coalition signature mechanism to provide a means for a coalition to bind its identity to a peace of information during its interactions within an e-commerce marketplace. the coalition signature environment includes a 
certificate authority  coalition representatives  and coalitions of a coalition structure. we detail the processes for certificate issuing  coalition certifying  coalition signing  coalition signature verifying  and coalition revocation. our performance analysis results show that the proposed coalition signature scheme can be implemented efficiently. 
 
keywords 
 
     e-commerce agent  coalition security  coalition signature 
 
1. introduction 
 
     the pervasive connectivity of the internet and the powerful architecture of world wide web are changing many market conventions and are creating tremendous opportunity for conducting business on internet. electronic commerce activities  such as on-line exchange of information services and products etc are bringing business to a whole new level of productivity and profitability. in parallel with the emergence of electronic commerce  there have been interesting developments in the area of intelligent software agents  or software entities that are capable of independent actions in open  unpredictable environments. the internet will never reach its full potential as an electronic marketplace unless e-commerce agents  or proactive web programs  are used to automatically or semi-automatically perform e-commerce tasks such as negotiation  bidding  auction  transaction  and matchmaking etc. as e-commerce agent technology becomes more mature and standardized  we may envision that tens of thousands of e-commerce agents will be seamlessly embedded in everywhere of the web. the dynamic and heterogeneous interactions among them and the automations brought by them will dramatically reduce certain types of frictional costs and time incurred in the exchange of commodities. however  before we fully enjoy the benefits brought by e-commerce agents  we must realize that the risk and vulnerability is also imminent: the ubiquitous existence of various software agents designed by all kinds of people can work  interact  and also attack at any time from anywhere of the  wild web   where the  distance  among them has collapsed to near zero and the transactions can be done instantly. the electronic linking  either wired or wireless  among various agents has made security an issue that must be woven into any agent-based service environment  especially when digital agents migrating through wireless or wired linkage from one network computer or device to another and sensing  executing  transacting  and interacting along the way. the security issues  we believe  that related to agents include but not limited to the following: keeping data or preference of an agent secrete from other agents except those who are authorized to access; ensuring data that belong to an agent not been altered by unauthorized agents; identifying and authenticating agents during agent interaction; verifying the source of data received by an agent; binding information to an agent; authorization during agents interaction; validation during agent interaction; access control in agent community; agent certification; acknowledging the receiving of data or services by agents; avoiding internet worms floods; the reputation and trust in mobile agent environment; and agent security against malicious hosts in the network  etc.  
     most of the existing researches in e-commerce agent security address the security issues with respect to a single agent in mobile computing environments. different from the traditional client/server model  the mobile agent model allows both nonexecutable messages and executable codes traverse the network.   thus  issues like trust for mobile agent  agent data integrity against malicious hosts and security key management must be addressed. robles et. al.   propose a trust model for multiagent marketplaces based on concentric spheres structure - physical security in the core  a security infrastructure in the middle spheres  and complex aspects of trust  such as reputation  fairness  and reliability  in the outer spheres. tahara et. al  propose a tool for agent data security. a visual tool is used to specify the behaviors of an agent. a mobile program encodes these formal specifications with formal logic. during an application  the activities of the agent can thus be verified by proving the corresponding logic notation encoded in the mobile program.  chan et. al   introduce a public key infrastructure to protect  a mobile agent during a comparison shopping process against malicious hosts that try to  manipulate and execute the agent's data. the strategy requires that each host and agent in the system to possess a pair of keys for encryption and decryption. each agent or host can encrypt or digitally sign the data items carried by the agent  thus providing security. loureiro et.al  propose a protocol for secure data collection based on an original secure cryptographic technique. their approach can maintain the integrity of the sequence of data segments such that data collected will not be modified or tempered by parties other than the real host. yi et. al  propose a secure electronic transaction protocol in which a trusted agent service center is incorporated into the payment system. this payment agent is used to perform secure transactions based on customers' requests. romao et. al  propose a proxy certificate mechanism in which the owner of an agent can delegate some power to the agent. their goal is to prevent the exposure of private keys when a mobile agent has to sign documents during internet transaction. 
     it is important to study the security issues for a single agent. however  it is even more important to study the security issues with respect to a group of interacting e-commerce agents. because it is the sheer interconnectedness and dynamic interactions among these agents that will make the future web a virtual dynamic marketplace  and at the same time  make the security issues one of the top issues to be addressed. in this paper  we study the security issues with respect to a very important multi-agent activity: the dynamic multi-agent coalition.  
     the remainder of this paper is organized as follows.  the next section details the issue of coalition security. section 1 proposes the coalition signature scheme for e-commerce multi-agent systems. section 1 briefly concludes the paper.  
 
1. coalition security 
 
     cooperation and sharing resource by creating coalitions of agents are an important way for autonomous agents to execute tasks and to maximize payoff. for example  e-commerce agents that represent self-interested real world parties such as buyers or sellers may explore the benefits of grouping by forming coalitions. coalition formation has been addressed by researchers from both the game theory community and the multi-agent community. game theory emphasizes the issues of n-person games formation under different settings and the distribution of the benefits among players  without providing algorithms that agents can use to form coalitions .  it concentrates on the stability and fairness issues for given coalitions. multi-agent research emphasizes the special properties of a multi-agent environment and considers the effects of communication costs and limited computation time  on the coalition formation process .   
     here we study a very important issue that has not been addressed before - the issue of coalition security. the advancement of technologies such as edi  kqml  fipa  bluetooth  semantic web  peer-to-peer  soap  concordia  voyager  odyssey  telescript  java  and servelet etc. will soon made the dynamic and heterogeneous interactions between tens of thousands of e-commerce agents a reality . under this environment  it will be a desired behavior for different agents to form coalitions for their own benefits. when coalitions are formed  securities will be an issue for agents belonging to different coalitions. thus  how to define signatures for different coalitions will be an issue that must be addressed. 
     in order to make our discussions easier  we define some concepts here. suppose that there are totally n agents: 
a={a1 ¦«  an}. here a is the set of the agents. the index for agent ai is i . a coalition c={ai1  ¦«   aim } is a subset of a such that  ij  ai j ¡Ê a   or in other words  c   a . if  agent a is alone  we assume that it forms a unit coalition {a}. a coalition structure cs at time t is the set of all the coalitions formed by agents in a   cs t   = {c1 ... ca }. where  a is the number of coalitions at time t   a =| cs t  |.  ci  1¡Ü i ¡Üa  is a coalition formed by agents of a   ci   a.  the coalitions 
discussed in our paper are dynamic. an agent might leave its current coalition and either becomes a unit coalition or join another coalition  or an agent that belongs to a unit coalition might join another coalition. 
     there are three basic kinds of coalition structures. the first kind is non-overlapping coalition structure  in the sense that there is no agent that belongs to two different coalitions. this is the coalition structure in the traditional sense - partitioning the set of agents into exhaustive and disjoint coalitions. for example  suppose that a = {a1 a1  a1   is the set of agents  then {{a1} {a1 a1}} is a non-overlapping coalition structure. a lot of research in coalition formations is related to non-overlapping coalition structure. the second kind is overlapping coalition structure  in the sense that an agent can appear in different coalitions  but no coalitions can contain another coalition. for example  {{a1 a1} {a1 a1}} is an overlapping coalition structure. the third kind is nested coalition structure  in the sense that partitioned coalitions can contain each other. for example  {{a1} {a1 a1} {a1}} is a nested coalition structure. sometimes  a coalition structure might be a combination of the above-mentioned kinds of coalition structures.  
     here we present a coalition signature mechanism that can be used by any kinds of dynamically changing coalition structure 
cs t   . a coalition signature mechanism  we believe  is fundamental in authentication  authorization  and non-repudiation for coalitions in an e-commerce multi-agent system. the purpose is to provide a means to bind identity of a multi-agent coalition to an agreement reached by the multi-agent coalition. the signature scheme for a given coalition c is based on identities of all members of c . a coalition signature sigc  m   on message m is just some bits that reflect the structure of the coalition. only a coalition itself can generate its own coalition signatures on messages. other coalitions or parties cannot forge any coalition signature of the given coalition. the authenticity of a coalition signature can be verified by any parties. the following section presents details of our approach. the following section presents details of our approach. 
 
1. coalition signature scheme 
 
     the coalition signature scheme is established on public key infrastructure  in which each agent has a pair of public and secret keys. the secret key of an agent is used to generate signatures on messages  while its public key is used for other agents or parties to verify its signatures. the secret key of an agent is generated by a trusted third party  the certificate authority  ca   in the beginning phase. the public key of an agent can be computed with the identity of the agent  ca is only activated whenever a new coalition is formed or an old coalition is dissolved.  suppose that a = {a1 ¦«  an} gives the set of agents in the multi-agent system. the identity for agent ai  is idi . thus the set of identities for agents in the multi-agent system are   ={id1 ¦«  idn }. usually the identity for an agent can be the name of the agent or simply the index of the agent in the given multi-agent system. in sections 1 - 1  we illustrate the process of generating and certifying signatures of a given coalition c ={ai1  ¦«  aik }. the identity information for agent ai j in c is idi j   where  1¡Ü j ¡Ü k . we represent the identity set of c as  c ={idi1  ¦«  idik }.  

fig. 1.  parties involved in the coalition signature mechanism. ca is the certificate authority that has secure channel with all the agents of the multi-agent system. agents that belong to one coalition are enclosed by a big circle. each coalition has a representative  represented as solid circle in the figure  that helps to form the coalition signature with respect to a given message. 
 
the following figure gives a high level illustration of signing and verifying processes. 

fig. 1.  the signing process and the  verifying process of the coalition signature scheme 
1 certificate issuing 
     in this section  we explain the procedure for ca to issue the secret certificate to individual agent.  
     based on rsa   ca randomly chooses two distinct big primes p and q and computes n= p¡¤ q and 
¦µ n  =  p  1  q  1  . then ca randomly chooses its public key e such that gcd e ¦µ n   =1and 1  e   ¦µ n  and computes its secret key d such that e ¡Á d =1 mod ¦µ n   . finally  ca distributes  e  n  to all participants  but keep 
 d  p  q   secret.  
     the following is the process for ca to issue a secret certificate to an individual agent ai j in s : 
step 1: obtain the hashed value hi j of the identity idi j of agent ai j   hi j = ¦§ idi j   . here ¦§ is a one-way      hash function that hashes an arbitrary length message into 1-bit message. there exists many ways to construct the hash function ¦§ . here we use secure hash standard  shs  . 
step 1:  obtain the signature si j for agent aij by transforming the hashed value hi j to:   
si j = hidj  mod n                                                                            1  
 step 1.  issue the secret certificate  idi j  si j   to aij through a secure channel. here idi j is the identity of  aij   and si j is the secret  key of  aij which is known only to the agent aij besides ca. 
 
1 coalition certifying 
     we explain the procedure for ca to certify an agent coalition when the coalition is formed as follows.  
     suppose that at time tc   a coalition c ={ai1  ¦«  aik } is formed. the representative of c is ai1 and the identity set of c is  c ={idi1  ¦«  idik }. ca certifies the coalition c by signing a message 
ic ={ c ={idi1  ¦«  idik } tc  lc }  where lc is the lifetime of the coalition. the terms tc and lc together specify the group formation dynamics of the multi-agent system - when and how long a group exists. 
     the signature sc of ca on the message ic is given by  
sc = h  i c  d  mod n                                                                  1  
where h  ic   stands for the hash value of ic with shs. ic and sc are passed to the coalition representative ai1 over a public channel. 
     the signature sc of ca on the message ic can be verified with the public key e of ca by checking whether   
sce = h  i c    mod n                                                                   1  
holds or not. if so  the coalition certified by ca is authentic. otherwise  it is a forged coalition. 
the coalition certifying process is shown in figure 1. 
 
1 coalition signing 
here we illustrate the procedure for the k agents in c to cooperatively sign a message m . we assume here that all the agents in c have already obtained their secret keys as described in section 1.  step 1:  each agent ai j first randomly chooses a value ri j  1   ri j   n    and then computes  
 
ti j = riej  mod n                                                                          1  
step 1:  each agent ai j submits ti j to the representative ai1 of coalition c . 
step 1:  ai1 computes t = ti1 ¡Á¦« ¡Átik  1 ¡Átik  mod n  on behalf of the coalition and then broadcasts t to members of the coalition. 
step 1:  after receiving t   each agent aij first computes m = ¦§ m t s c   and then computes  
di j = ri j simj  mod n                                                                    1  
and submits di j to ai1 .   
step 1: ai1 computes d = di1   di1  ¦«   dik  mod n  on behalf of the coalition c and constructs the coalition's signature 	sig c  m   	on 	m . 	sig c  m   	consists 	m  d  sc and 	ic . 	or  	in 	other 	words  sig c  m   ={m  sc   d  ic }. 
 
1 coalition signature verifying 
     here we illustrate the coalition signature verification process. the coalition signature sig c  m   ={m  sc   d  ic } on a message m can be verified by any verifier v in the following way: 
step 1: v checks the authenticity of the coalition according to equation sce = h  i c    mod n    here e is the public key of ca .  
step 1: v computes hi j = ¦§ idi j   for all the agents ai j  1¡Ü j ¡Ü k  that belong to s . then computes the value of h   h = hi1 ¦« hik 1 hik  mod n .   
step 1: v computes 
 t* = d hm  mod n                                                                    1  
step 1: v computes m* = ¦§ m  t*  s c   . 
step 1: if the above calculated value m* equals to the value of m in the coalition signature  then the coalition signature is valid. 
     the processes of signature signing and verifying are shown in figure 1. 
 
1. conclusion 
 
     the pervasive connectivity of the internet and the powerful architecture of world wide web will create a virtual marketplace where tens and thousands of agents can work  interact  and also attack from anywhere and at any time. the electronic linking  either wired or wireless  among various agents has made security an issue that must be woven into any agent-based service environment. in this paper  we propose a coalition signature scheme within a multi-agent environment. we show that the proposed theory is secure against forgery and that the coalition signature mechanism can be implemented efficiently. we believe that there are a lot of security issues when multiple agents interact with each other and we plan to explore more in the future. 
 
