   planning provides the basis for a theory of language generation that considers the communicative goals of the speaker when producing utterances. one central problem in designing a system based on such a theory is specifying the requisite linguistic knowledge in a form that interfaces well with a planning system and allows for the encoding of discourse information. the telegram  teleological grammar  system described in this paper solves this problem by annotating a unification grammar with assertions about how grammatical choices are used to achieve various goals  and by enabling the planner to augment the functional description of an utterance as it is being unified. the control structures of the planner and the grammar unifier are then merged in a manner that makes it possible for general planning to be guided by unification of a particular functional description. 
1. introduction 
   by viewing language generation as a planning process  one can not only account for the way people use language to satisfy different goals they have in mind  but also model the broad interaction between a speaker's physical and linguistic actions. formal models of planing can provide the basis for a theory of language generation in which communicative goals play a central role. recent research in natural-language generation  l  has established the feasibility of regarding planning as the basis for the generation of utterances. this paper examines some of the problems involved in devising a grammar formalism for such a generation system that produces utterances and describes a particular implementation of a unification grammar  referred to as telegram  that solves some of these problems. 
   the kamp system  was designed with the problems of multiple-goal satisfaction and the integration of physical and linguistic actions in mind. k a m p is a multiagent planning system that can be given a high-level description 
this research was supported by the national science foundation under grant mcs-1. the author is grateful to barbara gross for helpful comments on earlier drafts of this paper. 
of an agent's goals  and then produce a plan that includes the performance of both physical and linguistic actions by several agents that will achieve the agent's goals. in the development of kamp it was recognized that syntactic  semantic and pragmatic knowledge sources are necessary for the planning of utterances. these sources of knowledge were stored independently inside the system: a grammar was provided in addition to the axioms that constitute the agent's knowledge of the pragmatics of communication. however  rather than have one process that decides what to say  drawing on knowledge about the world and about communication  plus another independant process that decides how to encode that knowledge into english  kamp employs a single process that uses both sources of knowledge to produce plans. 
   the primary focus of the research on kamp was the representation and integration of the knowledge needed to make plans involving utterances. one area that was neglected was the representation of grammatical knowledge. kamp relies on a very simple grammar composed of context-free rules that enable it to generate simple sentences. such phenomena as gapping are totally outside of its capability. because of the ad hoc nature of the representation  modifications and extensions of its linguistic coverage are very difficult. 
   another criticism of kamp's approach was that there was no obvious way to control the planning process. instead of formulating a plan quickly  kamp would search a large space of linguistic alternatives until it found an 
 optimal  solution. as some critics have pointed out   e.g.    such exhaustive planning is often not needed in practical situations - and is certainly not how people produce utterances in real time. kamp would never produce an ungrammatical sentence  because it could always do unlimited backtracking after making an incorrect decision. 
   the remainder of this paper describes how to use a unification grammar* to address these two problems of 
representation and control. 
1. 	unification grammar 
a unification grammar characterizes linguistic entities 
* unification grammar has often been referred to as functional grammar in the literature  e.g.   1    1 . it b related to and shares many ideas with systemic grammar  1 . 
   
1 	d. appelt 
by collections of features called a functional description  fds . each of the features in an fd has a value that can be either atomic or another functional description. a unification grammar is a large fd that characterizes the features of every possible sentence in the language. in this paper  the fd that characterizes the intended utterance is called the text fd and the fd that constitutes the grammar is called the grammar fd. 
   the most salient feature of unification grammar that distinguishes it from other grammatical formalisms is its emphasis on linguistic function. all of the features used by the grammar have equal status  with functional and discourse-related features like topic and focus sharing equal status with grammatical roles like subject and predicate  and with syntactic categories like np and vp. 
   unification grammars are particularly well suited for language generation because they allow the encoding of discourse features in the grammar. a functional description can be constructed incorporating these features  and the syntactic details of the final utterance can then be specified through unification with the grammar fd. the process that constructs the text fd can treat it as a highlevel blueprint fleshed out by unification  thereby relieving the high-level process of the need to consider low-level grammatical details. this strategy was used by mckeown 
. 

whether or not the orderings represented by the two patterns are consistent. 
   in spite of its advantages  there are some serious problems with unification grammar if it is employed straightforwardly in a language planning system. one of the most serious problems is the inefficiency of the unification algorithm as described above. a straightforward application of that algorithm is very expensive  consuming an orderof-magnitude more time in the unification process than in the entire planning process leading up to the construction of the text fd . the problem is not simply one of efficiency of implementation. it is inherent in any algorithm that searches alternatives blindly and thereby does work that is exponentially related to the number of alternatives in the grammar. any solution to the problem must be a conceptual one that minimizes the number of alternatives that ever have to be considered. 
   another problem is that the text fd is not as high-level a blueprint as is really needed because every feature related to the speaker's intention to communicate must be part of the text fd when unification takes place. this implies  for example  that every descriptor that is part of a referring expression must be specified in advance. this may be unnecessary because for certain grammatical choices  the referring expression may be eliminated entirely. for example  in the by-phrase in a passive sentence  reference may be made pronominally  or not at all   in which case descriptors are unnecessary. since the planner must know the linguistic context when planning descriptors  a nounphrase fd is best constructed initially with a referent feature  and later expanded by adding features that correspond to the descriptors. 
   while it is conceivable that the grammar could be designed to expand a referent feature into a set of descriptors  that would amount to encoding in the grammar what is essentially a planning problem. this is undesirable because the grammar  being a repository of syntactic knowledge  should be separated from pragmatic knowledge. conversely  it is also desireable to separate detailed syntactic knowledge from the planner  and the failure to do so was a major shortcoming with kamp. 
   the next section describes how unification and planning can be combined to allow syntactic knowledge to be separated from the planner  but still allow the required flexibility of interaction between the planner and the grammar. 
1. 	combination of unification and planning 
   the telegram system solves the problems of efficiency and modularity through a close coupling between the processes of unification and planning.  the name telegram stands for teleological qrammar because planning and goal satisfaction are integreated into the unification process.  
   kamp divided its actions into an abstraction hierarchy. the action hierarchy  as it pertains to linguistic actions  
   

is shown in figure 1. actions called illocutionary acts are at the top of the hierarchy  with surface speech acts and concept activation actions falling below  while the actual performance of the utterance is at the lowest level. illocutionary acts are easily described at an abstract level that is best reasoned about by a conventional planning system  as was done in kamp  and by cohen  1|. however  as one progresses down the hierarchy  the planning becomes more and more dependent on the constraints of the grammar  although goal satisfaction is still very much a part of the reasoning that takes place. it is at the level of surface speech act and concept activation actions that the planning and unification processes can be most advantageously merged. 
   the means of combining planning and unification works as follows. at the time the planner plans to perform a surface speech act  enough information has been specified so that it knows the general syntactic structure of the sentence  declarative  interrogative  or imperative . a functional description of the utterance is created and then unified with the grammar. 
   this functional description is very general and does not contain sufficient information to specify a unique sentence. the functional description is elaborated during the process of unification so that it adds features incrementally to the functional description. the planner is called upon by the unification algorithm at the appropriate time to add the appropriate features. the end result is a functional description that is the same as if a complete functional 
	d. appelt 	1 
description of the intended utterance had been unified with the grammar by means of a conventional unification algorithm that does not invoke planning. 
   the planner is invoked by the unifier when either of two situations arises: 
  the unifier detects a feature in the text fd that has no corresponding feature in the grammar fd. such features are a signal that elaboration must be performed. the feature is annotated with a goal wff that the planner plans to achieve  and the resulting actions specify additions to the functional description being unified. the unification process then continues in the normal manner. 
  the unifier detects a choice in the grammar functional description that cannot be resolved through the unification of atomic features. each choice in the grammar is annotated with a wff that describes to the planner what the effects of making the choice will be. the planner then decides which alternative is most consistent with its plans  making an arbitrary choice if insufficient information is available for a decision. 
   the combination of planning and unification that results has a number of benefits resulting from annotating a grammar with information useful to the planner  rather than trying to work linguistic knowledge into the planner in an ad hoc manner. 
   the ability to perform action subsumption  the opportunistic  piggybacking  of related goals as described in   is enhanced. whether or not one can incorporate additional nonreferring descriptors into a noun phrase is governed by the structure and function of the noun phrase being planned. for example  a pronominal reference cannot incorporate any additional descriptors at all. therefore  if a planner were to decide whether or not to perform action subsumption  it would have to know in advance how a referent was going to be realized. if this were to be performed before unification  the planner would have to have the detailed linguistic knowledge to know that it was possible. with a simple grammar like kamp's this was possible  but with a larger grammar it is clearly undesirable. 
   the ability to do multiple-utterance and discourse planning is also enhanced. since the grammar and planner are closely coupled  information can be easily fed back from the grammar to the planner. this feedback is one of the features that distinguish a language planning system from a system that first decides what to say  then how to say it. when an alternative is chosen  the planner has information about the goal that is to be achieved through the selection of that alternative. if unification based on that selection fails  the planner  instead of blindly trying other alternatives  can revise the entire plan - including 
   
1 	d. appelt 
the incorporation of multiple utterances where only one was planned originally. 
1. 	example. 
　　this example illustrates how a language system can use an annotated unification gramar like telegram. suppose that there are two agents operating in an equipment assembly domain  and that the planning agent decides that the other agent should know that the location of a screwdriver 1 is in a particular toolbox  tbi. he then plans the illocutionary act** 

　　the planner then plans a surface speech act consisting of a declarative sentence with the same propositional content as the illocutionary act. however  instead of constructing a syntactic-structure tree by using context-free rules  as in kamp would do in this example  the telegram planner will create a high-level functional description of the intended utterance. for this example  the functional description would look like the following: 

at this point  the planner is no longer directly in control of the planning process. the planner invokes the unifier with the above text functional description and the grammar functional description  and relinquishes control to the unification process. 
　　the unification process follows the algorithm described in section 1  until there is either an alternative in the grammar that needs to be selected or some feature in the text fd does not unify with any feature in the grammar fd. 
　　in this example  the second of these situations arises when the noun phrase fd 

is unified with the functional description of a noun phrase from the grammar: 

　　the fd for the noun phrase tells what the structure of the constituent is  but it does not contain a referent feature. the straightforward application of the unification algorithm of section 1 would simply yield the grammar fd along with the feature  referent = tbi   which is not particularly useful. however  the feature referent has an annotation that tells the unifier that the planner should be invoked with the goal of activating the concept tbi for agt1. the planner then plans a concept activation action  using its knowledge about agtl and agt1's mutual knowledge  perhaps inserts a pointing action into the plan  and augments the text fd to resemble the following: 

　　the new augmented functional description still does not unify with the grammar fd  but the annotation for the desc feature is written to insert fds corresponding to each of the descriptors into the text fd. this next expansion results in the following fd: 

this fd can be unified directly with the grammar fd  using the algorithm described in section 1. it is identical to the one that would have been planned had the entire fd been specified at the start of the unification process. however  by postponing some of the planning  and placing it under control of the unification process  the system preserves the ability to plan hierarchically while enhancing its ability to coordinate physical and linguistic actions. 
1. 	comparison with related systems. 
   there are several significant differences between telegram and other natural-language-generation systems that 
   
have been developed using unification grammar or systemic grammar. 
   the text system developed by mckeown  uses a unification grammar to generate coherent multisentential text and employs a straightforward unification algorithm. the uniger does not draw upon the system's pragmatic knowledge to decide among alternatives in the grammar  and being reduced to blind search  it requires a great deal of time to unify a single text functional description. the text system does all its planning during the construction of the text fd and uses the unification process to fill in the grammatical details essential for producing the final utterance. 
   the nigel grammar designed by mann  is a systemic grammar  but the philosophies underlying systemic and unification grammar are so similar that a comparison of the systems is warranted. the system  choosers  of nigel play a role similar to the annotations on the alternatives in telegram  and many other parallels can be drawn. the most fundamental difference between the two systems is in the assmptions underlying their design. nigel is intended to be completely independent of any particular application system or knowledge representation  an intention that has influenced all aspects of its design. a consequence of this decision is a complete separation of the grammatical processes from the other processes in the system  permitting communication only through a narrow channel. telegram  on the other hand closely couples reasoning about syntactic choices with the other planning done by the system  thereby enabling the reasoning about combined physical and linguistic actions. however  telegram sacrifices some of the simplicity of the interface between the grammar and the rest of the system. 
1. 	summary and conclusion. 
   the telegram system described in this paper is an attempt to incorporate a large grammar into a languageplanning system. this particular approach to representing knowledge in an annotated unification grammar and combining the processes of planning and unification results in the following advantages: 
  greater efficiency in the lower levels of the planning process  because the planner can be invoked to decide among alternatives  thus avoiding the reliance upon blind search. 
  a simple method of resource allocation to the planning process by limiting the amount of backtracking the unifier is allowed to do. 
  the ability to combine reasoning about physical and linguistic actions with a grammar that provides significantly wide coverage of the language. 
   although the development of telegram is still in progress  early experience suggests that the telegram 
	d. appelt 	1 
formalism has sufficient power to represent the syntactic knowledge of a language-planning system that efficiently encompasses a significant portion of english. a small grammar has been written that already has more power than the grammar of kamp. research is being conducted in discovering those discourse-related features that have to be included in a unification grammar. although writing a  reversible  grammar does not appear to be feasible at this time  we hope this research will lead to the specification of a set of features that can be shared between unification grammars for parsing and for generation. 
