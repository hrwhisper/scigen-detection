in this paper  we present some first results in the extraction of semantic features from video sequences. our approach is based on the classification of mpeg dct macro-blocks. although it is clear that using macro-blocks imposes severe restrictions on the analysis accuracy of the image  it has the advantage of avoiding the complete decoding of the mpeg stream. our objective is to evaluate the quality of the semantic feature extraction that can be obtained with this direct approach  to serve as a comparative baseline with more elaborate approaches.
keywords: semantic classification  discrete cosine transform  gaussian mixture models  compressed domain.
1 introduction
the large amount of visual information  carried by video documents as well as still images  requires efficient and effective indexing and search tools  1  1 . the u.s. institute of standards and technology sponsors the serie of trec 1 conferences to promote progress in contentbased retrieval from digital video. our work takes place in this context where we focus on the feature extraction

task; video shots should be classified into the high level semantic concepts indoor  outdoor  cityscape  landscape  text overlay  face and people.
¡¡to extract relevant features  the content should in principle be decoded first. since this operation is time consuming  especially when a large video database should be processed  feature extraction directly from the compressed domain would be particularly interesting by providing fast and reliable information analysis and selection tools. lots of work have been conducted to achieve image or video analysis   however only few researchers have given solutions to this challenging task with limited decoding of the mpeg stream  1  1 .
¡¡in this paper  we propose to extract semantic features from 1 by 1 pixels dct macro-blockclassification. we have distinguished two types of features in the trec set  the region-level features like face and text overlay and the frame-level features like indoor  outdoor  cityscape  landscape and people that require elementary concepts like building  greenery  sky and water to be detected.
¡¡the next section details the supervised classification process via gaussian mixture models  1  1  of macroblocks. then we explainhow the final decision is taken by introducing new elementary concepts to describe framelevel semantics. finally  we will outline future improvements.
1
1 macro-block classification
in the context of supervised classification  three steps are involved: feature extraction and representation  class modelisation and parameter estimation  finally classification with respect to decision rules.
¡¡in our approach  features are directly provided by the video stream after parsing since we work only on iframes  which are encoded somehow like jpeg pictures. these frames are composed of macro-blocks that contain 1 dct blocks  1 for y color component  1 for u and 1 for v i.e. 1:1 video format. we can represent a dct macro-block by a vector of size 1 corresponding to the zigzag scan of the dct block coefficients and then make the concatenation of the 1 vectors to obtain the feature vector of the whole region. since the first dct coefficients are the most important i.e: to eye sensitivity and noise  the feature space dimension is simply reduced to 1 by truncation. moreover coefficients are scaled with respect to their importance in order to increase the sensitivity of the classifier to important components and at the same time to slightly improve the initialisation of the training algorithm  which is usually obtained via k-means algorithm as explained in the next subsection.
¡¡we assume a mixture model to describe the distribution of macro-blocks for each class  and specifically a multi-dimensional gaussian distribution. gaussian models can capture the characteristics of a macro-block  while modeling the variation due to motion or lighting conditions. moreover in   e.y. lam and j.w. goodman have proven that the distribution of macro-block dct coefficients can be well approximated by a gaussian when the variance is constant; in the classification situation  the latter hypothesis is more or less true and mixtures should compensate it. so the probability density function can be written as follows:
	for x	ci p x ¦µi¡Æ¦Áj pj x
jwhere ¦Ái ¦µi	¦Ìj ¦Òj and pj xn ¦Ìj ¦Òjthe gmm parameters ¦Áj ¦Ìj and ¦Òj are estimated using the traditional expectation-maximization algorithm  which is initialized with a classical k-means algorithm. in our current experiments  we also make the hypothesis that feature vector components are independent  thus ¦Òi is a diagonal matrix  or that only color components of the same frequency are correlated  thus ¦Òi is a matrix diagonal by block. finally the choice of the number of mixtures is simply achieved by looking at the test set loglikelihood evolution of the em algorithm for various mixture numbers. it should not increase to much in order to avoid data overfitting.
¡¡given an unlabeled macro-block x  the maximum a posteriori rule:
	c 	argmaxp ¦µi	x
i
gives an estimation of the class it belongs to. the posterior probabilities can be expanded by baye's rule:
finally ip xp ¦µix¡Ø p x ¦µi	p ¦µ x	p x ¦µi p ¦µi
since we assume the equiprobability of classes and vectors.
however  it is possible that a macro-block does not belong to any predefined class. thus we introduce for each model i a minimum bound mbi for the loglikelihood which is selected to eliminate 1% of the training data set. of course there is a trade-off to find between precision and recall  see figure 1. finally the decision rule can be written:
	c 	argmax p x ¦µi	log p x ¦µi	mbi
i
1 feature detection
the presented classification method allows to detect region-level features only. in our previous work  we have underlinedthat macro-blockscould not carry framelevel semantic information but succeed well in providing a lower level semantic. thus a heuristic two-step hierarchy  depicted in figure 1  was introduced to detect framelevel concepts via additional elementary semantics. the hierarchy contains three kinds of elements:
elementary concepts at the leaves of the hierarchy that are perceivable from macro-blocks 

figure 1: threshold selection
higher-level semantics on the upper part of the graph that are difficult to extract directly  but can be induced by a combination of lower-level features.
trec concepts  enclosed in boxes  that are spread in either of the previously stated categories.

figure 1: concepts hierarchy.
¡¡the detection of features present in one shot is finally achieved with respect to the following procedure:
1. classify all macro-blocks of the shot into elementary concepts with respect to preliminary trained gaussian mixtures 
1. compute a detection score for each feature.
¡¡the detection score of the feature i whose elementary childrens are j is simply defined by:
	dsi ¡Æp j where j	j
j
number of macro-blocks with label j
p j total number of macro-blocks in the shot
it represents the posterior probability of a feature to be in the given shot. finally  for each feature  shots are ordered by decreasing detection score.
1 experiments
nine video sequences were randomly selected in the development set in order to create training and test samples. some macro-blocs of these sequences were labeled with region-level concepts; half to perform the training of semantic classes and half to evaluate models. the fastidious annotation task was achieved over 1 frames and table 1 gives a summary of the accomplished task.
¡¡we have finally modeled classes by fifteen gaussian mixtures and truncated the space dimension to six by fifteen features. this values reveal to be a good compromise between performance and complexity. for the same reasons  we have approximated the co-variance matrix to a diagonal and not diagonal by block matrix  see table 1 that emphasizes the small improvementacquired by using a diagonal by block co-variance matrix.
selected sequences11a1b11b1bnb of selected frames11111nb of selected blocks11111featurestextskinclothesskytreebuildinggrasstarmachairwatergroundtotalnumber111111table 1: summary of the manual annotation.
featurestextskinclothesskytreebuildinggrasstarmachairwatergrounddiagonal by blockprecision111111recall111111diagonalprecision111111recall111111table 1: precision and recall during the development of the low level features.¡¡finally figures 1 and 1 show the performance of our method thanks to the assesor's judgement provided by trec. to evaluate the feature extraction task  we have represented the classical precision and recall curves for the four trec features outdoors  cityscape  text and face. encouraging results were obtained for outdoors and cityscape features  however we were expecting better results for text and face features since theyare relevantat the macro-block level and the developmentanalysis was forecasting good classification capacities  see table 1. several explanations can be envisaged: heterogenous sizes of training sets leading to overtrainedand undertrainedmodels and too few training variety conducting to restricted models  for example  no cartoon sequences were used to train models . the results we obtained using a single framework for all visual features  are closely comparable to submitted runs of other labs. in particular we get surprisingly good ranking in text ovelay detection.
1 conclusion
we have presented a method based on dct information of macro-blocks to detect trec visual features from video shots in a single framework. since macro-blocks carry only local information  a heuristic hierarchy was introduced to build the final decision rule at the frame-level and region-level. in gereral this evaluation is encouraging knowing the small extract of the development set used. in future works we plan to investigate methods to automatically elaborate the hierarchy. this will set up a complete probabilistic framework to detect features from low level observations and a more realistic manual annotation at the shot level will be required to train models.
